<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Differential Cryptanalysis Tutorial</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="js/toy.js"></script>
    <script src="js/spn.js"></script>
    <script src="js/visualization.js"></script>
    <link rel="stylesheet" href="css/colors.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/toc.css">
    <link rel="stylesheet" href="css/content.css">
    <link rel="stylesheet" href="css/visualization.css">
    <link rel="stylesheet" href="css/spn-visualization.css">
    <link rel="stylesheet" href="css/toy-visualization.css">
  </head>

  <body>
    <div id="sidebar">
</div>
<section id="content">
  <header>
    <img id="logo" src="images/logo.svg" width="80" />
    <h1>Differential Cryptanalysis Tutorial</h1>
  </header>
  <section>
    <h2>Abstract</h2>
    <p>This tutorial is a detailed and interactive introduction to differential cryptanalysis, a subtle, beautiful, and powerful method of breaking some of the world’s strongest ciphers. Unlike other currently available tutorials, it avoids needless math notation, makes very few assumptions about prior knowledge, does not gloss over details, and is written to be understood by novices with an interest in cryptography.</p>
    <p>Before continuing, know that there are two major prerequisites:</p>
    <ul>
      <li>You must be comfortable with binary and hexidecimal notation, especially how to convert between them</li>
      <li>We will be using differential cryptanalysis to break symmetric-key block ciphers. You should be familiar with this family of ciphers before learning a technique to break them</li>
    </ul>
  </section>
  <section>
    <h2>Introduction</h2>
    <p>Differential cryptanalysis was first discovered in the 1970s by the designers of the Data Encryption Standard (DES) at IBM. After a consultation with the NSA, the DES designers opted to keep the techinque a secret, because its release “would weaken the competitive advantage the United States enjoyed over other countries in the field of cryptography” {cite(biham)}. It remained classified until it was independently rediscovered and published in the early 1990s by Eli Biham and Adi Shamir, who are now credited with its discovery {cite(coppersmith)}.</p>
    <p>Before getting to the definition, it is important to note that differential cryptanalysis is what’s known as a “chosen plaintext” attack. This means that we, as attackers, may choose which plaintexts, and how many, we want encrypted by the cipher using the same secret key. This may not always be true in the real world since the same key often isn’t used for a very long time, and during that time it can be difficult or impossible to encrypt whichever plaintext you wish. Nevertheless, we must make this assumption for the attack to work.</p>
    <hr/>
    <p>Block ciphers work by repeatedly applying a set of transformations (key addition, substitution, permutation, etc.) to a plaintext, until a ciphertext is obtained. The security of the cipher depends on the attacker never knowing/guessing any intermediate value during encryption; we can only see the plaintext (remember, chosen plaintext) and ciphertext, nothing more.</p>
    <p>However, as we will explain thoroughly in this tutorial, we <em>can</em> know/guess the intermediate value of the <em>difference of two plaintexts</em> during encryption (this is why the technique is called <em>differential</em> cryptanalysis). This is a very subtle point and one that can be difficult to understand initially, but is paramount to understanding how differential cryptanalysis can recover the secret key and therefore break the cipher.</p>
    <p>As you will see, this “difference” is measured via a simple bitwise XOR of the two plaintexts.</em>
    <p>Now that we have the basics, let’s get to breaking our first cipher!</p>
  </section>
  <section>
    <h2>Components of Block Ciphers</h2>
    <p>This section is a short refresher on the components which make up the block ciphers we’ll be breaking. If you feel confident in your knowledge of key addition, SBOXes, and PBOXes, you are encouraged to skip this section.</p>
    <section>
      <h3>Block Ciphers</h3>
      <p>Block ciphers are symmetric key encryption algorithms which operate on a fixed-length <em>block</em> of bits. They take a fixed-length block as input and output an encrypted block of the same length. Decryption is done by running the encypted block backwards through the cipher. There are many ways to construct block ciphers, but most are made up of a repeated sequence of three simple transformations: key addition, substitution, and permutation.</p>
    </section>
    <section>
      <h3>Key Addition</h3>
      <p>Key addition is the step in which we introduce the secret/symmetric key. We do this by a bit-wise XOR of the key with the block. If, for example, our secret key was the bit string 11010010 and we had a block of bits, which <em>before</em> the key addition step had a value of 01101110 (block size is a byte), the value of the block <em>after</em> the key addition would be:</p>
      <table id="key-addition">
        <tr>
          <td></td>
          <td>01101110</td>
        </tr>
        <tr>
          <td>⊕</td>
          <td>11010010</td>
        </tr>
        <tr>
          <td></td>
          <td>10111100</td>
        </tr>
      </table>
    </section>
    <section>
      <h3>Substitution</h3>
      <p>Substitution is the step in which some bits are directly substituted for others. We define how these bits are substituted with a substitution-box (SBOX). Let’s define a simple 4-bit SBOX:
      <table id="substitution">
        <tr>
          <th colspan="17">SBOX</th>
        </tr>
        <tr>
          <th>Input:</th>
          <td>0</td>
          <td>1</td>
          <td>2</td>
          <td>3</td>
          <td>4</td>
          <td>5</td>
          <td>6</td>
          <td>7</td>
          <td>8</td>
          <td>9</td>
          <td>a</td>
          <td>b</td>
          <td>c</td>
          <td>d</td>
          <td>e</td>
          <td>f</td>
        </tr>
        <tr>
          <th>Output:</th>
          <td>e</td>
          <td>4</td>
          <td>d</td>
          <td>1</td>
          <td>2</td>
          <td>f</td>
          <td>b</td>
          <td>8</td>
          <td>3</td>
          <td>a</td>
          <td>6</td>
          <td>c</td>
          <td>5</td>
          <td>9</td>
          <td>0</td>
          <td>7</td>
        </tr>
      </table>
      <p>Note that both the input and output are represented using hexadecimal notation. As an example, if the input to this SBOX is 1011 (0xb), then we’ll get an output of 1100 (0xc) by simply looking it up in the table.</p>
      <p>The SBOX that a cipher uses is almost always released to the public. This is done to follow Kerckhoffs's principle which says that a cryptosystem should be secure even if everything about it―with the exception of the secret keys―is public knowledge. If everybody can see what the SBOX does, it might at first seem that substitution is pointless and insignificant because it’s so easly reversible. However, it is actually often the only part of a cipher which directly protects against differential cryptanalysis. Consequently, we’ll discuss substitution in a lot more depth throughout this tutorial.</p>
    </section>
    <section>
      <h3>Permutation</h3>
      <p>Permutation is the step in which we change the position of the bits. We define how these bits are permutated with a permutation-box (PBOX). Let’s define a simple 4-bit PBOX:</p>
      <table id="permutation">
        <tr>
          <th colspan="17">PBOX</th>
        </tr>
        <tr>
          <th>Input:</th>
          <td>0</td>
          <td>1</td>
          <td>2</td>
          <td>3</td>
        </tr>
        <tr>
          <th>Output:</th>
          <td>3</td>
          <td>0</td>
          <td>2</td>
          <td>1</td>
        </tr>
      </table>
      <p>This PBOX says that the bit at position 0 will move to position 3, the bit at position 1 will move to position 0, the bit at position 2 will move to position 2, and the bit at position 3 will move to position 1. Let’s see an example: if we input the nibble 1001 into the PBOX we should see that the output of the PBOX will be 0101. PBOXes, unlike SBOXes, are easy to represent visually:</p>
      <svg version="1.1" viewBox="60 30 90 125" xmlns="http://www.w3.org/2000/svg" id="pbox-svg">
  <!-- original viewBox="0 0 200 200" -->
  <g stroke="black">
    <!-- input -->
    <text x="60" y="50">1 0 0 1</text>

    <!-- lines -->
    <line x1="66" y1="55" x2="138" y2="130" stroke-width="3" />
    <line x1="90" y1="55" x2="66" y2="130" stroke-width="3" />
    <line x1="114" y1="55" x2="114" y2="130" stroke-width="3" />
    <line x1="138" y1="55" x2="90" y2="130" stroke-width="3" />

    <!-- output -->
    <text x="60" y="150">0 1 0 1</text>
  </g>
</svg>
      <p>Just like SBOXes, PBOXes are released to the public. Though SBOXes serve as the main protection against differential cryptanalysis, PBOXes also play a vital role which we will discuss later.</p>
      <p>
    </section>
  </section>
  <section>
    <header>
      <h2>Toy Cipher</h2>
      <blockquote>
        <p>If you can’t solve a problem, then there is an easier problem you can’t solve: find it.</p>
        <cite>—Pólya/Conway</cite>
      </blockquote>
    </header>
    <p>Let’s begin by breaking the simplest block cipher worth breaking which we’ll call the “toy cipher”. The toy cipher is <em>just</em> complicated enough to make differential cryptanalysis a valid method to break it, but no more. Note that it is trivial to break the toy cipher by bruteforce. Nevertheless, it will serve as a great introduction to the main concepts behind differential cryptanalysis.</p>
    <section>
      <h3>Toy Cipher Definition</h3>
      <p>The toy cipher has a block size of 4 bits (also known as a nibble), meaning that we’ll input 4 bits into the cipher and it will return 4 bits of ciphertext. The toy cipher also has a 4-bit substitution box (SBOX) and two separate 4-bit keys (<i>k</i><sub>1</sub> and <i>k</i><sub>2</sub>).</p>
      <p>Now let’s look at how we can encrypt a nibble with the toy cipher. There are three steps:</p>
      <ol>
        <li>We XOR the plaintext with <i>k</i><sub>1</sub></li>
        <li>Feed that result into the SBOX</li>
        <li>XOR the output of the SBOX with <i>k</i><sub>2</sub></li>
      </ol>
      <p>These simple steps give us the final ciphertext. The cipher is much easier to understand visually so look to the diagram below. The values underlined with purple can be changed, so play around with them to see how the cipher is affected. The red lines represent the 1s and the black lines the 0s as the nibble makes its way through the cipher. Also note the labels <i>x</i>, <i>u</i>, <i>v</i>, and <i>y</i> on the left (<i>x</i> is the value of the plaintext, <i>u</i> is the value after the first key addition, etc.). Those labels will make it easier to discuss the cipher when we get to differential cryptanalysis so keep them in mind.</p>
      <div class="visualization" id="toy-visualization">
  <div class="figure">
    <div class="plaintext">
      <span class="nibble1">0111</span>
    </div>
    <svg version="1.1" viewBox="51 45 110 245" xmlns="http://www.w3.org/2000/svg">
  <!-- original viewBox="0 0 600 905" -->
  <g stroke="black" stroke-width="2.5">
    <!-- round 1 key input -->
    <g class="x">
      <line x1="90" y1="45" x2="90" y2="80" class="b0" />
      <line x1="110" y1="45" x2="110" y2="80" class="b1" />
      <line x1="130" y1="45" x2="130" y2="80" class="b2" />
      <line x1="150" y1="45" x2="150" y2="80" class="b3" />
    </g>

    <!-- round 1 key -->
    <rect x="80" y="80" width="80" height="35" fill="transparent" />

    <!-- round 1 sbox input -->
    <g class="u">
      <line x1="90" y1="115" x2="90" y2="150" class="b0" />
      <line x1="110" y1="115" x2="110" y2="150" class="b1" />
      <line x1="130" y1="115" x2="130" y2="150" class="b2" />
      <line x1="150" y1="115" x2="150" y2="150" class="b3" />
    </g>

    <!-- round 1 sbox -->
    <rect x="80" y="150" width="80" height="35" fill="transparent" />

    <!-- round 2 key input -->
    <g class="v">
      <line x1="90" y1="185" x2="90" y2="220" class="b0" />
      <line x1="110" y1="185" x2="110" y2="220" class="b1" />
      <line x1="130" y1="185" x2="130" y2="220" class="b2" />
      <line x1="150" y1="185" x2="150" y2="220" class="b3" />
    </g>

    <!-- round 2 key -->
    <rect x="80" y="220" width="80" height="35" fill="transparent" />

    <!-- round 2 key output -->
    <g class="y">
      <line x1="90" y1="255" x2="90" y2="290" class="b0" />
      <line x1="110" y1="255" x2="110" y2="290" class="b1" />
      <line x1="130" y1="255" x2="130" y2="290" class="b2" />
      <line x1="150" y1="255" x2="150" y2="290" class="b3" />
    </g>
  </g>
  <g>
    <!-- K1 -->
    <text x="113" y="103">K</text>
    <text class="sub" x="125" y="107">1</text>
    <!-- K2 -->
    <text x="113" y="243">K</text>
    <text class="sub" x="125" y="247">2</text>

    <!-- x -->
    <text x="50" y="70">x</text>

    <!-- u1 -->
    <text x="50" y="140">u</text>
    <!-- v1 -->
    <text x="50" y="205">v</text>

    <!-- y -->
    <text x="50" y="280">y</text>

    <!-- S -->
    <text x="114" y="175">S</text>
  </g>
</svg>
    <div class="ciphertext">
      <span class="nibble1"></span>
    </div>
  </div>
  <div class="controls">
    <table class="sbox">
      <tr>
        <th colspan="17">SBOX</th>
      </tr>
      <tr>
        <th>Input:</th>
        <td>0</td>
        <td>1</td>
        <td>2</td>
        <td>3</td>
        <td>4</td>
        <td>5</td>
        <td>6</td>
        <td>7</td>
        <td>8</td>
        <td>9</td>
        <td>a</td>
        <td>b</td>
        <td>c</td>
        <td>d</td>
        <td>e</td>
        <td>f</td>
      </tr>
      <tr>
        <th>Output:</th>
        <td><input value='e' /></td>
        <td><input value='4' /></td>
        <td><input value='d' /></td>
        <td><input value='1' /></td>
        <td><input value='2' /></td>
        <td><input value='f' /></td>
        <td><input value='b' /></td>
        <td><input value='8' /></td>
        <td><input value='3' /></td>
        <td><input value='a' /></td>
        <td><input value='6' /></td>
        <td><input value='c' /></td>
        <td><input value='5' /></td>
        <td><input value='9' /></td>
        <td><input value='0' /></td>
        <td><input value='7' /></td>
      </tr>
    </table>
    <table class="plaintext-key-ciphertext">
      <tr>
        <td><b>Plaintext:</b></td>
        <td>0x<input class="plaintext-input" value='7' /></td>
      </tr>
      <tr>
        <td><b>Key 1:</b></td>
        <td>0x<input class="key1-input" value='b' /></td>
      </tr>
      <tr>
        <td><b>Key 2:</b></td>
        <td>0x<input class="key2-input" value='d' /></td>
      </tr>
      <tr>
        <td><b>Ciphertext:</b></td>
        <td class="ciphertext-output"></td>
      </tr>
    </table>
    <div class="error-messages">
      <p class="pbox-error" style="display: none;">PBOX is invalid. Make sure to only include hexadecimal digits (0 to f) and that the PBOX is one-to-one (i.e. there are no duplicates in the output).</p>
      <p class="sbox-error" style="display: none;">SBOX is invalid. Make sure to only include hexadecimal digits (0 to f) and that the SBOX is one-to-one (i.e. there are no duplicates in the output).</p>
    </div>
  </div>
  <script src="js/toy-visualization.js"></script>
</div>
    </section>
    <section>
      <h3>Differential Cryptanalysis of the Toy Cipher</h3>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
    </section>
  </section>
  <section>
    <h2>SPN</h2>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
    <div class="visualization" id="spn-visualization">
  <div class="figure">
    <div class="plaintext">
      <span class="nibble1">0100</span>
      <span class="nibble2">1011</span>
      <span class="nibble3">0001</span>
      <span class="nibble4">1101</span>
    </div>
    <svg version="1.1" viewBox="40 45 481 815" xmlns="http://www.w3.org/2000/svg">
  <!-- original viewBox="0 0 600 905" -->
  <g stroke="black" stroke-width="2.5">
    <!-- round 1 key input -->
    <g class="x">
      <line x1="90" y1="45" x2="90" y2="80" class="b0" />
      <line x1="110" y1="45" x2="110" y2="80" class="b1" />
      <line x1="130" y1="45" x2="130" y2="80" class="b2" />
      <line x1="150" y1="45" x2="150" y2="80" class="b3" />

      <line x1="210" y1="45" x2="210" y2="80" class="b4" />
      <line x1="230" y1="45" x2="230" y2="80" class="b5" />
      <line x1="250" y1="45" x2="250" y2="80" class="b6" />
      <line x1="270" y1="45" x2="270" y2="80" class="b7" />

      <line x1="330" y1="45" x2="330" y2="80" class="b8" />
      <line x1="350" y1="45" x2="350" y2="80" class="b9" />
      <line x1="370" y1="45" x2="370" y2="80" class="ba" />
      <line x1="390" y1="45" x2="390" y2="80" class="bb" />

      <line x1="450" y1="45" x2="450" y2="80" class="bc" />
      <line x1="470" y1="45" x2="470" y2="80" class="bd" />
      <line x1="490" y1="45" x2="490" y2="80" class="be" />
      <line x1="510" y1="45" x2="510" y2="80" class="bf" />
    </g>

    <!-- round 1 key -->
    <rect x="80" y="80" width="440" height="35" fill="transparent" />

    <!-- round 1 sbox input -->
    <g class="u1">
      <line x1="90" y1="115" x2="90" y2="150" class="b0" />
      <line x1="110" y1="115" x2="110" y2="150" class="b1" />
      <line x1="130" y1="115" x2="130" y2="150" class="b2" />
      <line x1="150" y1="115" x2="150" y2="150" class="b3" />

      <line x1="210" y1="115" x2="210" y2="150" class="b4" />
      <line x1="230" y1="115" x2="230" y2="150" class="b5" />
      <line x1="250" y1="115" x2="250" y2="150" class="b6" />
      <line x1="270" y1="115" x2="270" y2="150" class="b7" />

      <line x1="330" y1="115" x2="330" y2="150" class="b8" />
      <line x1="350" y1="115" x2="350" y2="150" class="b9" />
      <line x1="370" y1="115" x2="370" y2="150" class="ba" />
      <line x1="390" y1="115" x2="390" y2="150" class="bb" />

      <line x1="450" y1="115" x2="450" y2="150" class="bc" />
      <line x1="470" y1="115" x2="470" y2="150" class="bd" />
      <line x1="490" y1="115" x2="490" y2="150" class="be" />
      <line x1="510" y1="115" x2="510" y2="150" class="bf" />
    </g>

    <!-- round 1 sbox -->
    <rect x="80" y="150" width="80" height="35" fill="transparent" />
    <rect x="200" y="150" width="80" height="35" fill="transparent" />
    <rect x="320" y="150" width="80" height="35" fill="transparent" />
    <rect x="440" y="150" width="80" height="35" fill="transparent" />

    <!-- round 1 pbox -->
    <g class="v1">
      <line x1="90" y1="185" x2="90" y2="270" class="b0 pbox" />
      <line x1="110" y1="185" x2="210" y2="270" class="b1 pbox" />
      <line x1="130" y1="185" x2="330" y2="270" class="b2 pbox" />
      <line x1="150" y1="185" x2="450" y2="270" class="b3 pbox" />

      <line x1="210" y1="185" x2="110" y2="270" class="b4 pbox" />
      <line x1="230" y1="185" x2="230" y2="270" class="b5 pbox" />
      <line x1="250" y1="185" x2="350" y2="270" class="b6 pbox" />
      <line x1="270" y1="185" x2="470" y2="270" class="b7 pbox" />

      <line x1="330" y1="185" x2="130" y2="270" class="b8 pbox" />
      <line x1="350" y1="185" x2="250" y2="270" class="b9 pbox" />
      <line x1="370" y1="185" x2="370" y2="270" class="ba pbox" />
      <line x1="390" y1="185" x2="490" y2="270" class="bb pbox" />

      <line x1="450" y1="185" x2="150" y2="270" class="bc pbox" />
      <line x1="470" y1="185" x2="270" y2="270" class="bd pbox" />
      <line x1="490" y1="185" x2="390" y2="270" class="be pbox" />
      <line x1="510" y1="185" x2="510" y2="270" class="bf pbox" />
    </g>

    <!-- round 2 key -->
    <rect x="80" y="270" width="440" height="35" fill="transparent" />

    <!-- round 2 sbox input -->
    <g class="u2">
      <line x1="90" y1="305" x2="90" y2="340" class="b0" />
      <line x1="110" y1="305" x2="110" y2="340" class="b1" />
      <line x1="130" y1="305" x2="130" y2="340" class="b2" />
      <line x1="150" y1="305" x2="150" y2="340" class="b3" />

      <line x1="210" y1="305" x2="210" y2="340" class="b4" />
      <line x1="230" y1="305" x2="230" y2="340" class="b5" />
      <line x1="250" y1="305" x2="250" y2="340" class="b6" />
      <line x1="270" y1="305" x2="270" y2="340" class="b7" />

      <line x1="330" y1="305" x2="330" y2="340" class="b8" />
      <line x1="350" y1="305" x2="350" y2="340" class="b9" />
      <line x1="370" y1="305" x2="370" y2="340" class="ba" />
      <line x1="390" y1="305" x2="390" y2="340" class="bb" />

      <line x1="450" y1="305" x2="450" y2="340" class="bc" />
      <line x1="470" y1="305" x2="470" y2="340" class="bd" />
      <line x1="490" y1="305" x2="490" y2="340" class="be" />
      <line x1="510" y1="305" x2="510" y2="340" class="bf" />
    </g>

    <!-- round 2 sbox -->
    <rect x="80" y="340" width="80" height="35" fill="transparent" />
    <rect x="200" y="340" width="80" height="35" fill="transparent" />
    <rect x="320" y="340" width="80" height="35" fill="transparent" />
    <rect x="440" y="340" width="80" height="35" fill="transparent" />

    <!-- round 2 pbox -->
    <g class="v2">
      <line x1="90" y1="375" x2="90" y2="460" class="b0 pbox" />
      <line x1="110" y1="375" x2="210" y2="460" class="b1 pbox" />
      <line x1="130" y1="375" x2="330" y2="460" class="b2 pbox" />
      <line x1="150" y1="375" x2="450" y2="460" class="b3 pbox" />

      <line x1="210" y1="375" x2="110" y2="460" class="b4 pbox" />
      <line x1="230" y1="375" x2="230" y2="460" class="b5 pbox" />
      <line x1="250" y1="375" x2="350" y2="460" class="b6 pbox" />
      <line x1="270" y1="375" x2="470" y2="460" class="b7 pbox" />

      <line x1="330" y1="375" x2="130" y2="460" class="b8 pbox" />
      <line x1="350" y1="375" x2="250" y2="460" class="b9 pbox" />
      <line x1="370" y1="375" x2="370" y2="460" class="ba pbox" />
      <line x1="390" y1="375" x2="490" y2="460" class="bb pbox" />

      <line x1="450" y1="375" x2="150" y2="460" class="bc pbox" />
      <line x1="470" y1="375" x2="270" y2="460" class="bd pbox" />
      <line x1="490" y1="375" x2="390" y2="460" class="be pbox" />
      <line x1="510" y1="375" x2="510" y2="460" class="bf pbox" />
    </g>

    <!-- round 3 key -->
    <rect x="80" y="460" width="440" height="35" fill="transparent" />

    <!-- round 3 sbox input -->
    <g class="u3">
      <line x1="90" y1="495" x2="90" y2="530" class="b0" />
      <line x1="110" y1="495" x2="110" y2="530" class="b1" />
      <line x1="130" y1="495" x2="130" y2="530" class="b2" />
      <line x1="150" y1="495" x2="150" y2="530" class="b3" />

      <line x1="210" y1="495" x2="210" y2="530" class="b4" />
      <line x1="230" y1="495" x2="230" y2="530" class="b5" />
      <line x1="250" y1="495" x2="250" y2="530" class="b6" />
      <line x1="270" y1="495" x2="270" y2="530" class="b7" />

      <line x1="330" y1="495" x2="330" y2="530" class="b8" />
      <line x1="350" y1="495" x2="350" y2="530" class="b9" />
      <line x1="370" y1="495" x2="370" y2="530" class="ba" />
      <line x1="390" y1="495" x2="390" y2="530" class="bb" />

      <line x1="450" y1="495" x2="450" y2="530" class="bc" />
      <line x1="470" y1="495" x2="470" y2="530" class="bd" />
      <line x1="490" y1="495" x2="490" y2="530" class="be" />
      <line x1="510" y1="495" x2="510" y2="530" class="bf" />
    </g>

    <!-- round 3 sbox -->
    <rect x="80" y="530" width="80" height="35" fill="transparent" />
    <rect x="200" y="530" width="80" height="35" fill="transparent" />
    <rect x="320" y="530" width="80" height="35" fill="transparent" />
    <rect x="440" y="530" width="80" height="35" fill="transparent" />

    <!-- round 3 pbox -->
    <g class="v3">
      <line x1="90" y1="565" x2="90" y2="650" class="b0 pbox" />
      <line x1="110" y1="565" x2="210" y2="650" class="b1 pbox" />
      <line x1="130" y1="565" x2="330" y2="650" class="b2 pbox" />
      <line x1="150" y1="565" x2="450" y2="650" class="b3 pbox" />

      <line x1="210" y1="565" x2="110" y2="650" class="b4 pbox" />
      <line x1="230" y1="565" x2="230" y2="650" class="b5 pbox" />
      <line x1="250" y1="565" x2="350" y2="650" class="b6 pbox" />
      <line x1="270" y1="565" x2="470" y2="650" class="b7 pbox" />

      <line x1="330" y1="565" x2="130" y2="650" class="b8 pbox" />
      <line x1="350" y1="565" x2="250" y2="650" class="b9 pbox" />
      <line x1="370" y1="565" x2="370" y2="650" class="ba pbox" />
      <line x1="390" y1="565" x2="490" y2="650" class="bb pbox" />

      <line x1="450" y1="565" x2="150" y2="650" class="bc pbox" />
      <line x1="470" y1="565" x2="270" y2="650" class="bd pbox" />
      <line x1="490" y1="565" x2="390" y2="650" class="be pbox" />
      <line x1="510" y1="565" x2="510" y2="650" class="bf pbox" />
    </g>

    <!-- round 4 key -->
    <rect x="80" y="650" width="440" height="35" fill="transparent" />

    <!-- round 4 sbox input -->
    <g class="u4">
      <line x1="90" y1="685" x2="90" y2="720" class="b0" />
      <line x1="110" y1="685" x2="110" y2="720" class="b1" />
      <line x1="130" y1="685" x2="130" y2="720" class="b2" />
      <line x1="150" y1="685" x2="150" y2="720" class="b3" />

      <line x1="210" y1="685" x2="210" y2="720" class="b4" />
      <line x1="230" y1="685" x2="230" y2="720" class="b5" />
      <line x1="250" y1="685" x2="250" y2="720" class="b6" />
      <line x1="270" y1="685" x2="270" y2="720" class="b7" />

      <line x1="330" y1="685" x2="330" y2="720" class="b8" />
      <line x1="350" y1="685" x2="350" y2="720" class="b9" />
      <line x1="370" y1="685" x2="370" y2="720" class="ba" />
      <line x1="390" y1="685" x2="390" y2="720" class="bb" />

      <line x1="450" y1="685" x2="450" y2="720" class="bc" />
      <line x1="470" y1="685" x2="470" y2="720" class="bd" />
      <line x1="490" y1="685" x2="490" y2="720" class="be" />
      <line x1="510" y1="685" x2="510" y2="720" class="bf" />
    </g>

    <!-- round 4 sbox -->
    <rect x="80" y="720" width="80" height="35" fill="transparent" />
    <rect x="200" y="720" width="80" height="35" fill="transparent" />
    <rect x="320" y="720" width="80" height="35" fill="transparent" />
    <rect x="440" y="720" width="80" height="35" fill="transparent" />

    <!-- round 5 key input -->
    <g class="v4">
      <line x1="90" y1="755" x2="90" y2="790" class="b0" />
      <line x1="110" y1="755" x2="110" y2="790" class="b1" />
      <line x1="130" y1="755" x2="130" y2="790" class="b2" />
      <line x1="150" y1="755" x2="150" y2="790" class="b3" />

      <line x1="210" y1="755" x2="210" y2="790" class="b4" />
      <line x1="230" y1="755" x2="230" y2="790" class="b5" />
      <line x1="250" y1="755" x2="250" y2="790" class="b6" />
      <line x1="270" y1="755" x2="270" y2="790" class="b7" />

      <line x1="330" y1="755" x2="330" y2="790" class="b8" />
      <line x1="350" y1="755" x2="350" y2="790" class="b9" />
      <line x1="370" y1="755" x2="370" y2="790" class="ba" />
      <line x1="390" y1="755" x2="390" y2="790" class="bb" />

      <line x1="450" y1="755" x2="450" y2="790" class="bc" />
      <line x1="470" y1="755" x2="470" y2="790" class="bd" />
      <line x1="490" y1="755" x2="490" y2="790" class="be" />
      <line x1="510" y1="755" x2="510" y2="790" class="bf" />
    </g>

    <!-- round 5 key -->
    <rect x="80" y="790" width="440" height="35" fill="transparent" />

    <!-- round 5 key output -->
    <g class="y">
      <line x1="90" y1="825" x2="90" y2="860" class="b0" />
      <line x1="110" y1="825" x2="110" y2="860" class="b1" />
      <line x1="130" y1="825" x2="130" y2="860" class="b2" />
      <line x1="150" y1="825" x2="150" y2="860" class="b3" />

      <line x1="210" y1="825" x2="210" y2="860" class="b4" />
      <line x1="230" y1="825" x2="230" y2="860" class="b5" />
      <line x1="250" y1="825" x2="250" y2="860" class="b6" />
      <line x1="270" y1="825" x2="270" y2="860" class="b7" />

      <line x1="330" y1="825" x2="330" y2="860" class="b8" />
      <line x1="350" y1="825" x2="350" y2="860" class="b9" />
      <line x1="370" y1="825" x2="370" y2="860" class="ba" />
      <line x1="390" y1="825" x2="390" y2="860" class="bb" />

      <line x1="450" y1="825" x2="450" y2="860" class="bc" />
      <line x1="470" y1="825" x2="470" y2="860" class="bd" />
      <line x1="490" y1="825" x2="490" y2="860" class="be" />
      <line x1="510" y1="825" x2="510" y2="860" class="bf" />
    </g>
  </g>
  <g>
    <!-- K1 -->
    <text x="293" y="103">K</text>
    <text class="sub" x="305" y="107">1</text>
    <!-- K2 -->
    <text x="293" y="293">K</text>
    <text class="sub" x="305" y="297">2</text>
    <!-- K3 -->
    <text x="293" y="483">K</text>
    <text class="sub" x="305" y="487">3</text>
    <!-- K4 -->
    <text x="293" y="673">K</text>
    <text class="sub" x="305" y="677">4</text>
    <!-- K5 -->
    <text x="293" y="813">K</text>
    <text class="sub" x="305" y="817">5</text>

    <!-- x -->
    <text x="40" y="70">x</text>

    <!-- u1 -->
    <text x="40" y="140">u</text>
    <text class="sub" x="53" y="145">1</text>
    <!-- v1 -->
    <text x="40" y="205">v</text>
    <text class="sub" x="53" y="210">1</text>
    <!-- w1 -->
    <text x="40" y="260">w</text>
    <text class="sub" x="53" y="265">1</text>

    <!-- u2 -->
    <text x="40" y="330">u</text>
    <text class="sub" x="53" y="335">2</text>
    <!-- v2 -->
    <text x="40" y="395">v</text>
    <text class="sub" x="53" y="400">2</text>
    <!-- w2 -->
    <text x="40" y="450">w</text>
    <text class="sub" x="53" y="455">2</text>

    <!-- u3 -->
    <text x="40" y="520">u</text>
    <text class="sub" x="53" y="525">3</text>
    <!-- v3 -->
    <text x="40" y="585">v</text>
    <text class="sub" x="53" y="590">3</text>
    <!-- w3 -->
    <text x="40" y="640">w</text>
    <text class="sub" x="53" y="645">3</text>

    <!-- u4 -->
    <text x="40" y="710">u</text>
    <text class="sub" x="53" y="715">4</text>
    <!-- v4 -->
    <text x="40" y="780">v</text>
    <text class="sub" x="53" y="785">4</text>

    <!-- y -->
    <text x="40" y="850">y</text>

    <!-- S -->
    <text x="114" y="175">S</text>
    <text x="234" y="175">S</text>
    <text x="354" y="175">S</text>
    <text x="474" y="175">S</text>

    <text x="114" y="365">S</text>
    <text x="234" y="365">S</text>
    <text x="354" y="365">S</text>
    <text x="474" y="365">S</text>

    <text x="114" y="555">S</text>
    <text x="234" y="555">S</text>
    <text x="354" y="555">S</text>
    <text x="474" y="555">S</text>

    <text x="114" y="745">S</text>
    <text x="234" y="745">S</text>
    <text x="354" y="745">S</text>
    <text x="474" y="745">S</text>
  </g>
</svg>
    <div class="ciphertext">
      <span class="nibble1"></span>
      <span class="nibble2"></span>
      <span class="nibble3"></span>
      <span class="nibble4"></span>
    </div>
  </div>
  <div class="controls">
    <table class="sbox">
      <tr>
        <th colspan="17">SBOX</th>
      </tr>
      <tr>
        <th>Input:</th>
        <td>0</td>
        <td>1</td>
        <td>2</td>
        <td>3</td>
        <td>4</td>
        <td>5</td>
        <td>6</td>
        <td>7</td>
        <td>8</td>
        <td>9</td>
        <td>a</td>
        <td>b</td>
        <td>c</td>
        <td>d</td>
        <td>e</td>
        <td>f</td>
      </tr>
      <tr>
        <th>Output:</th>
        <td><input value='e' /></td>
        <td><input value='4' /></td>
        <td><input value='d' /></td>
        <td><input value='1' /></td>
        <td><input value='2' /></td>
        <td><input value='f' /></td>
        <td><input value='b' /></td>
        <td><input value='8' /></td>
        <td><input value='3' /></td>
        <td><input value='a' /></td>
        <td><input value='6' /></td>
        <td><input value='c' /></td>
        <td><input value='5' /></td>
        <td><input value='9' /></td>
        <td><input value='0' /></td>
        <td><input value='7' /></td>
      </tr>
    </table>
    <table class="pbox">
      <tr>
        <th colspan="17">PBOX</th>
      </tr>
      <tr>
        <th>Input:</th>
        <td>0</td>
        <td>1</td>
        <td>2</td>
        <td>3</td>
        <td>4</td>
        <td>5</td>
        <td>6</td>
        <td>7</td>
        <td>8</td>
        <td>9</td>
        <td>a</td>
        <td>b</td>
        <td>c</td>
        <td>d</td>
        <td>e</td>
        <td>f</td>
      </tr>
      <tr>
        <th>Output:</th>
        <td><input value='0' /></td>
        <td><input value='4' /></td>
        <td><input value='8' /></td>
        <td><input value='c' /></td>
        <td><input value='1' /></td>
        <td><input value='5' /></td>
        <td><input value='9' /></td>
        <td><input value='d' /></td>
        <td><input value='2' /></td>
        <td><input value='6' /></td>
        <td><input value='a' /></td>
        <td><input value='e' /></td>
        <td><input value='3' /></td>
        <td><input value='7' /></td>
        <td><input value='b' /></td>
        <td><input value='f' /></td>
      </tr>
    </table>
    <table class="plaintext-key-ciphertext">
      <tr>
        <td><b>Plaintext:</b></td>
        <td>0x<input class="plaintext-input" value='4b1d' /></td>
      </tr>
      <tr>
        <td><b>Key 1:</b></td>
        <td>0x<input class="key1-input" value='1a6d' /></td>
      </tr>
      <tr>
        <td><b>Key 2:</b></td>
        <td>0x<input class="key2-input" value='2ac2' /></td>
      </tr>
      <tr>
        <td><b>Key 3:</b></td>
        <td>0x<input class="key3-input" value='452f' /></td>
      </tr>
      <tr>
        <td><b>Key 4:</b></td>
        <td>0x<input class="key4-input" value='6ff1' /></td>
      </tr>
      <tr>
        <td><b>Key 5:</b></td>
        <td>0x<input class="key5-input" value='b520' /></td>
      </tr>
      <tr>
        <td><b>Ciphertext:</b></td>
        <td class="ciphertext-output"></td>
      </tr>
    </table>
    <div class="error-messages">
      <p class="pbox-error" style="display: none;">PBOX is invalid. Make sure to only include hexadecimal digits (0 to f) and that the PBOX is one-to-one (i.e. there are no duplicates in the output).</p>
      <p class="sbox-error" style="display: none;">SBOX is invalid. Make sure to only include hexadecimal digits (0 to f) and that the SBOX is one-to-one (i.e. there are no duplicates in the output).</p>
    </div>
  </div>
  <script src="js/spn-visualization.js"></script>
</div>
    <section>
      <h3>SPN Definition</h3>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
    </section>
    <section>
      <h3>Differential Cryptanalysis of an SPN</h3>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
    </section>
  </section>
  <section>
    <h2>Modern Cryptography</h2>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
  </section>
  <section>
    <h2>Bibliography</h2>
    <ol id="bibliography">
      <li id="biham">Biham, Eli and Adi Shamir. “Differential Cryptanalysis of DES-like Cryptosystems.” <i>Journal of Cryptology</i> 4, no. 1 (January 1991): 3–72. https://doi.org/10.1007/BF00630563.</li>
      <li id="coppersmith">Coppersmith, Don. “The Data Encryption Standard (DES) and its strength against attacks” <i>IBM Journal of Research and Development</i> 38, no. 3 (May 1994): 243–250. https://doi.org/10.1147/rd.383.0243.</li>
    </ol>
  </section>
</section>
<script src="js/generate-section-numbers.js"></script>
<script src="js/generate-citation-numbers.js"></script>
<script src="js/generate-toc.js"></script>
  </body>
</html>
