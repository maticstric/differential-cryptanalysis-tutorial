<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Differential Cryptanalysis Tutorial</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="js/toy.js"></script>
    <script src="js/spn.js"></script>
    <script src="js/visualization.js"></script>
    <link rel="stylesheet" href="css/colors.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/toc.css">
    <link rel="stylesheet" href="css/content.css">
    <link rel="stylesheet" href="css/visualization.css">
    <link rel="stylesheet" href="css/spn-visualization.css">
    <link rel="stylesheet" href="css/toy-visualization.css">
  </head>

  <body>
    <div id="sidebar">
</div>
<section id="content">
  <header>
    <img id="logo" src="images/logo.svg" width="80" />
    <h1>Differential Cryptanalysis Tutorial</h1>
  </header>
  <section>
    <h2>Abstract</h2>
    <p>This tutorial is a detailed and interactive introduction to differential cryptanalysis, a subtle, beautiful, and powerful method of breaking some of the world’s strongest ciphers. Unlike other currently available tutorials, it avoids needless math notation, makes very few assumptions about prior knowledge, does not gloss over details, and is written to be understood by novices with an interest in cryptography.</p>
    <p>Before continuing, know that there are two major prerequisites:</p>
    <ul>
      <li>You must be comfortable with binary and hexidecimal notation, especially how to convert between them</li>
      <li>We will be using differential cryptanalysis to break symmetric-key block ciphers. You should be familiar with this family of ciphers before learning a technique to break them</li>
    </ul>
  </section>
  <section>
    <h2>Introduction</h2>
    <p>Differential cryptanalysis was first discovered in the 1970s by the designers of the Data Encryption Standard (DES) at IBM. After a consultation with the NSA, the DES designers opted to keep the techinque a secret, because its release “would weaken the competitive advantage the United States enjoyed over other countries in the field of cryptography” {cite(biham)}. It remained classified until it was independently rediscovered and published in the early 1990s by Eli Biham and Adi Shamir, who are now credited with its discovery {cite(coppersmith)}.</p>
    <p>Before getting to the definition, it is important to note that differential cryptanalysis is what’s known as a <span class="highlight"><em>chosen plaintext</em></span> attack. This means that we, as attackers, may choose which plaintexts, and how many, we want encrypted by the cipher using the same secret key. This may not always be true in the real world since the same key often isn’t used for a very long time, and during that time it can be difficult or impossible to encrypt whichever plaintext you wish. Nevertheless, we must make this assumption for the attack to work.</p>
    <hr/>
    <p>Block ciphers work by repeatedly applying a set of transformations (key addition, substitution, permutation, etc.) to a plaintext, until a ciphertext is obtained. The security of the cipher depends on the attacker never knowing/guessing any intermediate value during encryption; we can only see the plaintext (remember, chosen plaintext) and ciphertext, nothing more.</p>
    <p>However, as we will explain thoroughly in this tutorial, we <em>can</em> know/guess the intermediate value of the <em>difference of two plaintexts</em> during encryption (this is why the technique is called <em>differential</em> cryptanalysis). This is a very subtle point and one that can be difficult to understand initially, but is paramount to understanding how differential cryptanalysis can recover the secret key and therefore break the cipher.</p>
    <p>As you will see, this “difference” is measured via a simple bitwise XOR of the two plaintexts.</em>
    <p>Now that we have the basics, let’s get to breaking our first cipher!</p>
  </section>
  <section>
    <h2>Components of Block Ciphers</h2>
    <p>This section is a short refresher on the components which make up the block ciphers we’ll be breaking. If you feel confident in your knowledge of key addition, SBOXes, and PBOXes, you are encouraged to skip this section.</p>
    <section>
      <h3>Block Ciphers</h3>
      <p>Block ciphers are symmetric key encryption algorithms which operate on a fixed-length <em>block</em> of bits. They take a fixed-length block as input and output an encrypted block of the same length. Decryption is done by running the encypted block backwards through the cipher. There are many ways to construct block ciphers, but most are made up of a repeated sequence of three simple transformations: key addition, substitution, and permutation.</p>
    </section>
    <section>
      <h3>Key Addition</h3>
      <p>Key addition is the step in which we introduce the secret/symmetric key. We do this by a bit-wise XOR of the key with the block. Remember that the XOR of two bits is defined by this function:</p>
      <table class="monospaced-table" id="xor">
        <tr>
          <td><i>b</i><sub>1</sub></td>
          <td><i>b</i><sub>2</sub></td>
          <td><i>b</i><sub>1</sub> ⊕ <i>b</i><sub>2</sub></td>
        </tr>
        <tr>
          <td>0</td>
          <td>0</td>
          <td>0</td>
        </tr>
        <tr>
          <td>0</td>
          <td>1</td>
          <td>1</td>
        </tr>
        <tr>
          <td>1</td>
          <td>0</td>
          <td>1</td>
        </tr>
        <tr>
          <td>1</td>
          <td>1</td>
          <td>0</td>
        </tr>
      </table>
      <p>If, for example, our secret key was the bit string 11010010 and we had a block of bits, which <em>before</em> the key addition step had a value of 01101110 (block size is one byte), the value of the block <em>after</em> the key addition would be:</p>
      <table id="key-addition">
        <tr>
          <td></td>
          <td>01101110</td>
        </tr>
        <tr>
          <td>⊕</td>
          <td>11010010</td>
        </tr>
        <tr>
          <td></td>
          <td>10111100</td>
        </tr>
      </table>
    </section>
    <section>
      <h3>Substitution</h3>
      <p>Substitution is the step in which some bits are directly substituted for others. We define how these bits are substituted with a substitution-box (SBOX). Let’s define a simple 4-bit SBOX:
      <table class="monospaced-table" id="substitution">
        <tr>
          <th colspan="17">SBOX</th>
        </tr>
        <tr>
          <th>Input:</th>
          <td>0</td>
          <td>1</td>
          <td>2</td>
          <td>3</td>
          <td>4</td>
          <td>5</td>
          <td>6</td>
          <td>7</td>
          <td>8</td>
          <td>9</td>
          <td>a</td>
          <td>b</td>
          <td>c</td>
          <td>d</td>
          <td>e</td>
          <td>f</td>
        </tr>
        <tr>
          <th>Output:</th>
          <td>e</td>
          <td>4</td>
          <td>d</td>
          <td>1</td>
          <td>2</td>
          <td>f</td>
          <td>b</td>
          <td>8</td>
          <td>3</td>
          <td>a</td>
          <td>6</td>
          <td>c</td>
          <td>5</td>
          <td>9</td>
          <td>0</td>
          <td>7</td>
        </tr>
      </table>
      <p>Note that both the input and output are represented using hexadecimal notation. As an example, if the input to this SBOX is 1011 (0xb), then we’ll get an output of 1100 (0xc) by simply looking it up in the table.</p>
      <p>The SBOX that a cipher uses is almost always released to the public. This is done in accordance with Kerckhoffs’s principle which says that a cryptosystem should be secure even if everything about it―with the exception of the secret keys―is public knowledge. Just because the SBOX is public and therefore easily reversible does not mean that substitution is pointless or insignificant. In fact, it is often the only part of a cipher which directly protects against differential cryptanalysis. Consequently, we’ll discuss substitution in much more depth throughout this tutorial.</p>
    </section>
    <section>
      <h3>Permutation</h3>
      <p>Permutation is a step in which we change the position of the bits. We define how these bits are permutated with a permutation-box (PBOX). Let’s define a simple 4-bit PBOX:</p>
      <table class="monospaced-table" id="permutation-4">
        <tr>
          <th colspan="17">PBOX</th>
        </tr>
        <tr>
          <th>Input:</th>
          <td>0</td>
          <td>1</td>
          <td>2</td>
          <td>3</td>
        </tr>
        <tr>
          <th>Output:</th>
          <td>3</td>
          <td>0</td>
          <td>2</td>
          <td>1</td>
        </tr>
      </table>
      <p>This PBOX says that the bit at position 0 will move to position 3, the bit at position 1 will move to position 0, the bit at position 2 will stay at position 2, and the bit at position 3 will move to position 1. For example, if we input the nibble 1001 into the PBOX, we will get an output of 0101. PBOXes, unlike SBOXes, are easy to represent visually:</p>
      <svg version="1.1" viewBox="60 30 90 125" xmlns="http://www.w3.org/2000/svg" id="pbox-svg">
  <!-- original viewBox="0 0 200 200" -->
  <g stroke="black">
    <!-- input -->
    <text x="60" y="50">1 0 0 1</text>

    <!-- lines -->
    <line x1="66" y1="55" x2="138" y2="130" stroke-width="3" />
    <line x1="90" y1="55" x2="66" y2="130" stroke-width="3" />
    <line x1="114" y1="55" x2="114" y2="130" stroke-width="3" />
    <line x1="138" y1="55" x2="90" y2="130" stroke-width="3" />

    <!-- output -->
    <text x="60" y="150">0 1 0 1</text>
  </g>
</svg>
      <p>Just like SBOXes, PBOXes are released to the public. Though SBOXes serve as the main protection against differential cryptanalysis, PBOXes also play a vital role which we will discuss later.</p>
      <p>
    </section>
  </section>
  <section>
    <header>
      <h2>Toy Cipher</h2>
      <blockquote>
        <p>If you can’t solve a problem, then there is an easier problem you can’t solve: find it.</p>
        <cite>—Pólya/Conway</cite>
      </blockquote>
    </header>
    <p>Let’s begin by breaking the simplest block cipher worth breaking which we’ll call the “toy cipher”. The toy cipher is <em>just</em> complicated enough to make differential cryptanalysis a valid method to break it, but no more. Note that it is trivial to break the toy cipher by bruteforce. Nevertheless, it will serve as a great introduction to the main concepts behind differential cryptanalysis.</p>
    <section>
      <h3>Toy Cipher Definition</h3>
      <p>The toy cipher has a block size of 4 bits (also known as a nibble), meaning that we’ll input 4 bits into the cipher and it will return 4 bits of ciphertext. The toy cipher has a 4-bit SBOX and two separate 4-bit keys (<i>k</i><sub>1</sub> and <i>k</i><sub>2</sub>).</p>
      <p>Now let’s look at how we can encrypt a nibble with the toy cipher. There are three steps:</p>
      <ol>
        <li>We XOR the plaintext with <i>k</i><sub>1</sub></li>
        <li>Feed that result into the SBOX</li>
        <li>XOR the output of the SBOX with <i>k</i><sub>2</sub></li>
      </ol>
      <p>These simple steps give us the final ciphertext. The cipher is much easier to understand visually so look to the figure below. The values underlined with purple can be changed, so play around with them to see how the cipher is affected. The red lines represent the 1s and the black lines the 0s as the nibble makes its way through the cipher. Also note the labels <i>x</i>, <i>u</i>, <i>v</i>, and <i>y</i> on the left (<i>x</i> is the value of the plaintext, <i>u</i> is the value after the first key addition, etc.). Those labels will make it easier to discuss the cipher when we get to differential cryptanalysis so keep them in mind.</p>
      <div class="visualization" id="toy-visualization">
  <div class="figure">
    <div class="plaintext">
      <span class="nibble1">0111</span>
    </div>
    <svg version="1.1" viewBox="51 45 110 245" xmlns="http://www.w3.org/2000/svg">
  <!-- original viewBox="0 0 600 905" -->
  <g stroke="black" stroke-width="2.5">
    <!-- round 1 key input -->
    <g class="x">
      <line x1="90" y1="45" x2="90" y2="80" class="b0" />
      <line x1="110" y1="45" x2="110" y2="80" class="b1" />
      <line x1="130" y1="45" x2="130" y2="80" class="b2" />
      <line x1="150" y1="45" x2="150" y2="80" class="b3" />
    </g>

    <!-- round 1 key -->
    <rect x="80" y="80" width="80" height="35" fill="transparent" />

    <!-- round 1 sbox input -->
    <g class="u">
      <line x1="90" y1="115" x2="90" y2="150" class="b0" />
      <line x1="110" y1="115" x2="110" y2="150" class="b1" />
      <line x1="130" y1="115" x2="130" y2="150" class="b2" />
      <line x1="150" y1="115" x2="150" y2="150" class="b3" />
    </g>

    <!-- round 1 sbox -->
    <rect x="80" y="150" width="80" height="35" fill="transparent" />

    <!-- round 2 key input -->
    <g class="v">
      <line x1="90" y1="185" x2="90" y2="220" class="b0" />
      <line x1="110" y1="185" x2="110" y2="220" class="b1" />
      <line x1="130" y1="185" x2="130" y2="220" class="b2" />
      <line x1="150" y1="185" x2="150" y2="220" class="b3" />
    </g>

    <!-- round 2 key -->
    <rect x="80" y="220" width="80" height="35" fill="transparent" />

    <!-- round 2 key output -->
    <g class="y">
      <line x1="90" y1="255" x2="90" y2="290" class="b0" />
      <line x1="110" y1="255" x2="110" y2="290" class="b1" />
      <line x1="130" y1="255" x2="130" y2="290" class="b2" />
      <line x1="150" y1="255" x2="150" y2="290" class="b3" />
    </g>
  </g>
  <g>
    <!-- K1 -->
    <text x="113" y="103">K</text>
    <text class="sub" x="125" y="107">1</text>
    <!-- K2 -->
    <text x="113" y="243">K</text>
    <text class="sub" x="125" y="247">2</text>

    <!-- x -->
    <text x="50" y="70">x</text>

    <!-- u1 -->
    <text x="50" y="140">u</text>
    <!-- v1 -->
    <text x="50" y="205">v</text>

    <!-- y -->
    <text x="50" y="280">y</text>

    <!-- S -->
    <text x="114" y="175">S</text>
  </g>
</svg>
    <div class="ciphertext">
      <span class="nibble1"></span>
    </div>
  </div>
  <div class="controls">
    <table class="sbox">
      <tr>
        <th colspan="17">SBOX</th>
      </tr>
      <tr>
        <th>Input:</th>
        <td>0</td>
        <td>1</td>
        <td>2</td>
        <td>3</td>
        <td>4</td>
        <td>5</td>
        <td>6</td>
        <td>7</td>
        <td>8</td>
        <td>9</td>
        <td>a</td>
        <td>b</td>
        <td>c</td>
        <td>d</td>
        <td>e</td>
        <td>f</td>
      </tr>
      <tr>
        <th>Output:</th>
        <td><input value='e' /></td>
        <td><input value='4' /></td>
        <td><input value='d' /></td>
        <td><input value='1' /></td>
        <td><input value='2' /></td>
        <td><input value='f' /></td>
        <td><input value='b' /></td>
        <td><input value='8' /></td>
        <td><input value='3' /></td>
        <td><input value='a' /></td>
        <td><input value='6' /></td>
        <td><input value='c' /></td>
        <td><input value='5' /></td>
        <td><input value='9' /></td>
        <td><input value='0' /></td>
        <td><input value='7' /></td>
      </tr>
    </table>
    <table class="plaintext-key-ciphertext">
      <tr>
        <td><b>Plaintext:</b></td>
        <td>0x<input class="plaintext-input" value='7' /></td>
      </tr>
      <tr>
        <td><b>Key 1:</b></td>
        <td>0x<input class="key1-input" value='b' /></td>
      </tr>
      <tr>
        <td><b>Key 2:</b></td>
        <td>0x<input class="key2-input" value='d' /></td>
      </tr>
      <tr>
        <td><b>Ciphertext:</b></td>
        <td class="ciphertext-output"></td>
      </tr>
    </table>
    <div class="error-messages">
      <p class="pbox-error" style="display: none;">PBOX is invalid. Make sure to only include hexadecimal digits (0 to f) and that the PBOX is one-to-one (i.e. there are no duplicates in the output).</p>
      <p class="sbox-error" style="display: none;">SBOX is invalid. Make sure to only include hexadecimal digits (0 to f) and that the SBOX is one-to-one (i.e. there are no duplicates in the output).</p>
    </div>
  </div>
  <script src="js/toy-visualization.js"></script>
</div>
    </section>
    <section>
      <h3>Differential Cryptanalysis of the Toy Cipher</h3>
      <p>Much of the following is based on King's webpage: “Differential Cryptanalysis Tutorial” {cite(king)} as well as Stinson's textbook <i>Cryptography: Theory and Practice</i> {cite(stinson)}.</p>
      <p>We must begin by defining which SBOX we’ll be using for the toy cipher. Remember that SBOXes are public knowledge and that, once the cipher is defined, they do not change. So, we’ll pick an arbitrary SBOX for our toy cipher.</p>
      <table class="monospaced-table" id="substitution">
        <tr>
          <th colspan="17">SBOX</th>
        </tr>
        <tr>
          <th>Input:</th>
          <td>0</td>
          <td>1</td>
          <td>2</td>
          <td>3</td>
          <td>4</td>
          <td>5</td>
          <td>6</td>
          <td>7</td>
          <td>8</td>
          <td>9</td>
          <td>a</td>
          <td>b</td>
          <td>c</td>
          <td>d</td>
          <td>e</td>
          <td>f</td>
        </tr>
        <tr>
          <th>Output:</th>
          <td>e</td>
          <td>4</td>
          <td>d</td>
          <td>1</td>
          <td>2</td>
          <td>f</td>
          <td>b</td>
          <td>8</td>
          <td>3</td>
          <td>a</td>
          <td>6</td>
          <td>c</td>
          <td>5</td>
          <td>9</td>
          <td>0</td>
          <td>7</td>
        </tr>
      </table>
      <p>Differential cryptanalysis stems from the analysis of the XOR of two plaintexts as they travel through the cipher. The reason XOR is used is because it tells us where two plaintexts differ. If their XOR at some bit position is 1, then those two plaintexts differ at that bit position.</p>
      <p>For now, instead of focusing on the cipher as a whole, we’ll simply analyze the SBOX. Let’s first choose an XOR value to analyze: 1011. We can make a table of all possible pairs of SBOX inputs, call them <i>x</i> and <i>x</i><sup>*</sup>, which XOR to 1011 (in other words, all inputs which differ in the first, third, and fourth bit positions).</p>
      <table class="monospaced-table" id="xor-input-table">
        <tr>
          <th><i>x</i></th>
          <th><i>x</i><sup>*</sup></th>
          <th><i>x</i> ⊕ <i>x</i><sup>*</sup></th>
        </tr>
        <tr>
          <td>0000</td>
          <td>1011</td>
          <td>1011</td>
        </tr>
        <tr>
          <td>0001</td>
          <td>1010</td>
          <td>1011</td>
        </tr>
        <tr>
          <td>0010</td>
          <td>1001</td>
          <td>1011</td>
        </tr>
        <tr>
          <td>0011</td>
          <td>1000</td>
          <td>1011</td>
        </tr>
        <tr>
          <td>0100</td>
          <td>1111</td>
          <td>1011</td>
        </tr>
        <tr>
          <td>0101</td>
          <td>1110</td>
          <td>1011</td>
        </tr>
        <tr>
          <td>0110</td>
          <td>1101</td>
          <td>1011</td>
        </tr>
        <tr>
          <td>0111</td>
          <td>1100</td>
          <td>1011</td>
        </tr>
        <tr>
          <td>1000</td>
          <td>0011</td>
          <td>1011</td>
        </tr>
        <tr>
          <td>1001</td>
          <td>0010</td>
          <td>1011</td>
        </tr>
        <tr>
          <td>1010</td>
          <td>0001</td>
          <td>1011</td>
        </tr>
        <tr>
          <td>1011</td>
          <td>0000</td>
          <td>1011</td>
        </tr>
        <tr>
          <td>1100</td>
          <td>0111</td>
          <td>1011</td>
        </tr>
        <tr>
          <td>1101</td>
          <td>0110</td>
          <td>1011</td>
        </tr>
        <tr>
          <td>1110</td>
          <td>0101</td>
          <td>1011</td>
        </tr>
        <tr>
          <td>1111</td>
          <td>0100</td>
          <td>1011</td>
        </tr>
      </table>
      <p>Now, let’s consider the XOR of the SBOX <em>outputs</em> of both <i>x</i> and <i>x</i><sup>*</sup>. Let’s name those outputs <i>y</i> and <i>y</i><sup>*</sup> respectively. In other words, if we put the input <i>x</i> through the SBOX we defined earlier, we’ll get <i>y</i>, and if we input <i>x</i><sup>*</sup>, we’ll get <i>y</i><sup>*</sup>.</p>
      <table class="monospaced-table" id="xor-input-output-table">
        <tr>
          <th><i>x</i></th>
          <th><i>x</i><sup>*</sup></th>
          <th><i>x</i> ⊕ <i>x</i><sup>*</sup></th>
          <th><i>y</i></th>
          <th><i>y</i><sup>*</sup></th>
          <th><i>y</i> ⊕ <i>y</i><sup>*</sup></th>
        </tr>
        <tr>
          <td>0000</td>
          <td>1011</td>
          <td>1011</td>
          <td>1110</td>
          <td>1100</td>
          <td>0010</td>
        </tr>
        <tr>
          <td>0001</td>
          <td>1010</td>
          <td>1011</td>
          <td>0100</td>
          <td>0110</td>
          <td>0010</td>
        </tr>
        <tr>
          <td>0010</td>
          <td>1001</td>
          <td>1011</td>
          <td>1101</td>
          <td>1010</td>
          <td>0111</td>
        </tr>
        <tr>
          <td>0011</td>
          <td>1000</td>
          <td>1011</td>
          <td>0001</td>
          <td>0011</td>
          <td>0010</td>
        </tr>
        <tr>
          <td>0100</td>
          <td>1111</td>
          <td>1011</td>
          <td>0010</td>
          <td>0111</td>
          <td>0101</td>
        </tr>
        <tr>
          <td>0101</td>
          <td>1110</td>
          <td>1011</td>
          <td>1111</td>
          <td>0000</td>
          <td>1111</td>
        </tr>
        <tr>
          <td>0110</td>
          <td>1101</td>
          <td>1011</td>
          <td>1011</td>
          <td>1001</td>
          <td>0010</td>
        </tr>
        <tr>
          <td>0111</td>
          <td>1100</td>
          <td>1011</td>
          <td>1000</td>
          <td>0101</td>
          <td>1101</td>
        </tr>
        <tr>
          <td>1000</td>
          <td>0011</td>
          <td>1011</td>
          <td>0011</td>
          <td>0001</td>
          <td>0010</td>
        </tr>
        <tr>
          <td>1001</td>
          <td>0010</td>
          <td>1011</td>
          <td>1010</td>
          <td>1101</td>
          <td>0111</td>
        </tr>
        <tr>
          <td>1010</td>
          <td>0001</td>
          <td>1011</td>
          <td>0110</td>
          <td>0100</td>
          <td>0010</td>
        </tr>
        <tr>
          <td>1011</td>
          <td>0000</td>
          <td>1011</td>
          <td>1100</td>
          <td>1110</td>
          <td>0010</td>
        </tr>
        <tr>
          <td>1100</td>
          <td>0111</td>
          <td>1011</td>
          <td>0101</td>
          <td>1000</td>
          <td>1101</td>
        </tr>
        <tr>
          <td>1101</td>
          <td>0110</td>
          <td>1011</td>
          <td>1001</td>
          <td>1011</td>
          <td>0010</td>
        </tr>
        <tr>
          <td>1110</td>
          <td>0101</td>
          <td>1011</td>
          <td>0000</td>
          <td>1111</td>
          <td>1111</td>
        </tr>
        <tr>
          <td>1111</td>
          <td>0100</td>
          <td>1011</td>
          <td>0111</td>
          <td>0010</td>
          <td>0101</td>
        </tr>
      </table>
      <p>Here we see the heart of differential cryptanalysis. Examine the values of <i>y</i> ⊕ <i>y</i><sup>*</sup> and notice the repetitions. Let’s create another table to see how many times each value appears in the SBOX output XORs.</p>
      <table class="monospaced-table" id="xor-appearances-table">
        <tr>
          <th>Output XOR</th>
          <th>Appearances</th>
        </tr>
        <tr>
          <td>0000</td>
          <td>0</td>
        </tr>
        <tr>
          <td>0001</td>
          <td>0</td>
        </tr>
        <tr>
          <td>0010</td>
          <td class="highlight">8</td>
        </tr>
        <tr>
          <td>0011</td>
          <td>0</td>
        </tr>
        <tr>
          <td>0100</td>
          <td>0</td>
        </tr>
        <tr>
          <td>0101</td>
          <td class="highlight">2</td>
        </tr>
        <tr>
          <td>0110</td>
          <td>0</td>
        </tr>
        <tr>
          <td>0111</td>
          <td class="highlight">2</td>
        </tr>
        <tr>
          <td>1000</td>
          <td>0</td>
        </tr>
        <tr>
          <td>1001</td>
          <td>0</td>
        </tr>
        <tr>
          <td>1010</td>
          <td>0</td>
        </tr>
        <tr>
          <td>1011</td>
          <td>0</td>
        </tr>
        <tr>
          <td>1100</td>
          <td>0</td>
        </tr>
        <tr>
          <td>1101</td>
          <td class="highlight">2</td>
        </tr>
        <tr>
          <td>1110</td>
          <td>0</td>
        </tr>
        <tr>
          <td>1111</td>
          <td class="highlight">2</td>
        </tr>
      </table>
      <p>Consider what this table is really saying. If we pick two random plaintexts which XOR to 1011, put each of them through the SBOX, and then XOR those SBOX outputs, 8 out of 16 times, they will XOR to 0010. They will XOR to 0111 2 out of 16 times. They will never XOR to 1010. This bias towards certain XORs is what makes differential cryptanalysis possible.</p>
      <p>So far we’ve only considered the input XOR of 1011. We can repeat the same process for every possible input XOR and build what is called a <em class="highlight">difference distribution table</em> for the given SBOX. The rows in this table represent the SBOX input XOR, the columns represent the SBOX output XOR, and the cell values are the number of appearances of that output XOR given the input XOR. Note that the XORs are represented in hexadecimal instead of binary (e.g. you can find the previous example of 1011 in the row labeled b).</p>
      <table class="monospaced-table" id="difference-distribution-table">
        <tr>
          <th>Input</th>
          <th colspan="16">Output XOR</th>
        </tr>
        <tr>
          <th>XOR</th>
          <th>0</th>
          <th>1</th>
          <th>2</th>
          <th>3</th>
          <th>4</th>
          <th>5</th>
          <th>6</th>
          <th>7</th>
          <th>8</th>
          <th>9</th>
          <th>a</th>
          <th>b</th>
          <th>c</th>
          <th>d</th>
          <th>e</th>
          <th>f</th>
        </tr>
        <tr>
          <th>0</th>
          <td class="highlight">16</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
        </tr>
        <tr>
          <th>1</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">4</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
        </tr>
        <tr>
          <th>2</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">6</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
        </tr>
        <tr>
          <th>3</th>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
        </tr>
        <tr>
          <th>4</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">6</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
        </tr>
        <tr>
          <th>5</th>
          <td>0</td>
          <td class="highlight">4</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
        </tr>
        <tr>
          <th>6</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
        </tr>
        <tr>
          <th>7</th>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
        </tr>
        <tr>
          <th>8</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
        </tr>
        <tr>
          <th>9</th>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
        </tr>
        <tr>
          <th>a</th>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">6</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td>0</td>
        </tr>
        <tr>
          <th>b</th>
          <td>0</td>
          <td>0</td>
          <td class="highlight">8</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
        </tr>
        <tr>
          <th>c</th>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">6</td>
          <td>0</td>
          <td>0</td>
        </tr>
        <tr>
          <th>d</th>
          <td>0</td>
          <td class="highlight">4</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
        </tr>
        <tr>
          <th>e</th>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">4</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">6</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
        </tr>
        <tr>
          <th>f</th>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">6</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
        </tr>
      </table>
      <hr/>
      <p>This table gives us probabilities for what happens to the XOR of two plaintexts as they individually travel through the SBOX. However, besides the SBOX, the cipher also includes key addition. So, before we get to breaking the keys, we must consider what happens to the XOR of two plaintexts as we put them through key addition.</p>
      <p>Let’s consider two plaintexts:</p>
      <table class="monospaced-table math">
        <tr>
          <td>
            <p><i>x</i> = 0111</p>
          </td>
        </tr>
        <tr>
          <td>
            <p><i>x</i><sup>*</sup> = 1100</p>
          </td>
        </tr>
        <tr>
          <td>
            <p><i>x</i> ⊕ <i>x</i><sup>*</sup> = <span class="highlight">1011</span></p>
          </td>
        </tr>
      </table>
      <p>Now let’s choose a key that we’ll add to both:</p>
      <table class="monospaced-table math">
        <tr>
          <td>
            <p><i>k</i> = 1010</p>
          </td>
        </tr>
        <tr>
          <td>
            <p><i>x</i> ⊕ <i>k</i> = 0111 ⊕ 1010 = 1101</p>
          </td>
        </tr>
        <tr>
          <td>
            <p><i>x</i><sup>*</sup> ⊕ <i>k</i> = 1100 ⊕ 1010 = 0110</p>
          </td>
        </tr>
      </table>
      <p>Now let’s see what value we get when we XOR the outputs of this key addition:</p>
      <table class="monospaced-table math">
        <tr>
          <td>
            <p>(<i>x</i> ⊕ <i>k</i>) ⊕ (<i>x</i><sup>*</sup> ⊕ <i>k</i>) = 1101 ⊕ 0110 = <span class="highlight">1011</span></p>
          </td>
        </tr>
      </table>
      <p>You should see that both <i>x</i> ⊕ <i>x</i><sup>*</sup> and (<i>x</i> ⊕ <i>k</i>) ⊕ (<i>x</i><sup>*</sup> ⊕ <i>k</i>) come out to the same value. This should be apparent because of a few mathematical facts: XOR is associative, XOR is commutative, a value XORed by itself is zero, and a value XORed by zero is itself. We can therefore prove the previous statement like so:</p>
      <table class="monospaced-table math">
        <tr>
          <td>
            <p>(<i>x</i> ⊕ <i>k</i>) ⊕ (<i>x</i><sup>*</sup> ⊕ <i>k</i>)</p>
          </td>
        </tr>
        <tr>
          <td>
            <p>= <i>x</i> ⊕ <i>x</i><sup>*</sup> ⊕ <i>k</i> ⊕ <i>k</i></p>
          </td>
        </tr>
        <tr>
          <td>
            <p>= <i>x</i> ⊕ <i>x</i><sup>*</sup> ⊕ 0</p>
          </td>
        </tr>
        <tr>
          <td>
            <p>= <i>x</i> ⊕ <i>x</i><sup>*</sup></p>
          </td>
        </tr>
      </table>
      <p>This is an incredibly useful realization. Given the XOR of two plaintexts, we can predict with 100% certainty what their XOR will be after key addition—it will always stay the same. Remember that with the SBOX, the best prediction we have is only 50%, and many are much worse than that.</p>
      <p>The fact that keys become essentially useless when we use this attack should convince us that we’re on the right track. This is also why SBOXes are an absolutely <em>essential</em> part of many ciphers. You will see in the next section that even when we also consider permutations, SBOXes are still the only protection against attacks like differential cryptanalysis.</p>
      <hr/>
      <p>Now we can begin breaking the keys.</p>
      <p>Because differential cryptanalysis is a chosen plaintext attack we’ll need to encrypt plaintexts in order to break the keys. For that, however, we need to choose which keys will be used for encryption. For now let’s assume that <i>k</i><sub>1</sub> = 0xb and <i>k</i><sub>2</sub> = 0xd. Of course, when differential cryptanalysis is used in the real world the keys are unknown to the attackers. But some keys <em>need</em> to be chosen and this is just a tutorial so we might as well know them beforehand.</p>
      <p>The first step is to pick a <em class="highlight">differential characteristic</em> (this is just an input and output XOR pair). Let’s just choose a random one which has a non-zero value in the difference distribution table: 0x5 ➝ 0xa.</p>
      <p>Next we must find a pair of plaintexts which XOR to 0x5 and whose associated ciphertexts XOR to 0xa. Such a pair is called a <em class="highlight">good pair</em> for that given differential characteristic. You will see how a good pair is useful in a second.</p>
      <p>Assuming <i>k</i><sub>1</sub> = 0xb and <i>k</i><sub>2</sub> = 0xd, one good pair is 0x6 and 0x3. They encrypt to 0x4 and 0xe respectively, and 0x4 ⊕ 0xe = 0xa. You can confirm this using the toy cipher visualization at the beginning of this section or by hand.</p>
      <div class="visualization">
        <div class="figure">
          <svg version="1.1" viewBox="51 10 540 290" xmlns="http://www.w3.org/2000/svg" id="toy-dc-unfinished">
  <!-- original viewBox="0 0 600 905" -->

  <!-- Text -->

  <g stroke="black" stroke-width="0.5" id="mid-text">
    <text x="197" y="30">Values</text>
    <text x="310" y="30">XOR</text>
    <text x="402" y="30">Values</text>

    <line x1="180" y1="41" x2="460" y2="41" stroke-width="2" />

    <text x="207" y="65">0x6</text>
    <text x="310" y="65">0x5</text>
    <text x="413" y="65">0x3</text>

    <text x="213" y="137">?</text>
    <text x="310" y="137">0x5</text>
    <text x="419" y="137">?</text>

    <text x="213" y="209">?</text>
    <text x="310" y="209">0xa</text>
    <text x="419" y="209">?</text>

    <text x="207" y="278">0x4</text>
    <text x="310" y="278">0xa</text>
    <text x="413" y="278">0xe</text>
  </g>


  <!-- Toy 1 -->
  <g stroke="black" stroke-width="2.5">
    <!-- round 1 key input -->
    <g class="x">
      <line x1="90" y1="45" x2="90" y2="80" class="b0" />
      <line x1="110" y1="45" x2="110" y2="80" class="b1 isOne" />
      <line x1="130" y1="45" x2="130" y2="80" class="b2 isOne" />
      <line x1="150" y1="45" x2="150" y2="80" class="b3" />
    </g>

    <!-- round 1 key -->
    <rect x="80" y="80" width="80" height="35" fill="transparent" />

    <!-- round 1 sbox input -->
    <g class="u">
      <line x1="90" y1="115" x2="90" y2="150" class="b0" />
      <line x1="110" y1="115" x2="110" y2="150" class="b1" />
      <line x1="130" y1="115" x2="130" y2="150" class="b2" />
      <line x1="150" y1="115" x2="150" y2="150" class="b3" />
    </g>

    <!-- round 1 sbox -->
    <rect x="80" y="150" width="80" height="35" fill="transparent" />

    <!-- round 2 key input -->
    <g class="v">
      <line x1="90" y1="185" x2="90" y2="220" class="b0" />
      <line x1="110" y1="185" x2="110" y2="220" class="b1" />
      <line x1="130" y1="185" x2="130" y2="220" class="b2" />
      <line x1="150" y1="185" x2="150" y2="220" class="b3" />
    </g>

    <!-- round 2 key -->
    <rect x="80" y="220" width="80" height="35" fill="transparent" />

    <!-- round 2 key output -->
    <g class="y">
      <line x1="90" y1="255" x2="90" y2="290" class="b0" />
      <line x1="110" y1="255" x2="110" y2="290" class="b1 isOne" />
      <line x1="130" y1="255" x2="130" y2="290" class="b2" />
      <line x1="150" y1="255" x2="150" y2="290" class="b3" />
    </g>
  </g>
  <g>
    <!-- K1 -->
    <text x="113" y="103">K</text>
    <text class="sub" x="125" y="107">1</text>
    <!-- K2 -->
    <text x="113" y="243">K</text>
    <text class="sub" x="125" y="247">2</text>

    <!-- x -->
    <text x="50" y="70">x</text>

    <!-- u1 -->
    <text x="50" y="140">u</text>
    <!-- v1 -->
    <text x="50" y="205">v</text>

    <!-- y -->
    <text x="50" y="280">y</text>

    <!-- S -->
    <text x="114" y="175">S</text>
  </g>


  <!-- Toy 2 -->
  <g stroke="black" stroke-width="2.5">
    <!-- round 1 key input -->
    <g class="x">
      <line x1="490" y1="45" x2="490" y2="80" class="b0" />
      <line x1="510" y1="45" x2="510" y2="80" class="b1" />
      <line x1="530" y1="45" x2="530" y2="80" class="b2 isOne" />
      <line x1="550" y1="45" x2="550" y2="80" class="b3 isOne" />
    </g>

    <!-- round 1 key -->
    <rect x="480" y="80" width="80" height="35" fill="transparent" />

    <!-- round 1 sbox input -->
    <g class="u">
      <line x1="490" y1="115" x2="490" y2="150" class="b0" />
      <line x1="510" y1="115" x2="510" y2="150" class="b1" />
      <line x1="530" y1="115" x2="530" y2="150" class="b2" />
      <line x1="550" y1="115" x2="550" y2="150" class="b3" />
    </g>

    <!-- round 1 sbox -->
    <rect x="480" y="150" width="80" height="35" fill="transparent" />

    <!-- round 2 key input -->
    <g class="v">
      <line x1="490" y1="185" x2="490" y2="220" class="b0" />
      <line x1="510" y1="185" x2="510" y2="220" class="b1" />
      <line x1="530" y1="185" x2="530" y2="220" class="b2" />
      <line x1="550" y1="185" x2="550" y2="220" class="b3" />
    </g>

    <!-- round 2 key -->
    <rect x="480" y="220" width="80" height="35" fill="transparent" />

    <!-- round 2 key output -->
    <g class="y">
      <line x1="490" y1="255" x2="490" y2="290" class="b0 isOne" />
      <line x1="510" y1="255" x2="510" y2="290" class="b1 isOne" />
      <line x1="530" y1="255" x2="530" y2="290" class="b2 isOne" />
      <line x1="550" y1="255" x2="550" y2="290" class="b3" />
    </g>
  </g>
  <g>
    <!-- K1 -->
    <text x="513" y="103">K</text>
    <text class="sub" x="525" y="107">1</text>
    <!-- K2 -->
    <text x="513" y="243">K</text>
    <text class="sub" x="525" y="247">2</text>

    <!-- x -->
    <text x="575" y="70">x</text>

    <!-- u1 -->
    <text x="575" y="140">u</text>
    <!-- v1 -->
    <text x="575" y="205">v</text>

    <!-- y -->
    <text x="575" y="280">y</text>

    <!-- S -->
    <text x="514" y="175">S</text>
  </g>
</svg>
        </div>
      </div>
      <p>Now let’s see how this good pair will travel through the cipher. Above is a figure showing what is being explained here. We’ll be referencing the letters on the sides of the figure.</p>
      <p>We know that at <i>x</i> the value on the left is 0x6, the value on the right is 0x3, and their XOR is 0x5. We also know that at <i>y</i> the value on the left is 0x4, the value on the right is 0xe, and their XOR is 0xa. These are all values which we’ve hand picked. Now, what is the XOR at <i>u</i>? As explained earlier, the XOR doesn’t change over key addition, so it remains at 0x5. Since the XOR at <i>y</i> is 0xa, we can follow the same logic and conclude that the XOR at <i>v</i> must also be 0xa.</p>
      <p>But what are the values at <i>u</i> and <i>v</i>?</p>
      <p>Assuming the keys are unknown to us, there’s no easy way to tell. However, we do know that whatever the values at <i>u</i> are, they must XOR to 0x5 and whatever the values at <i>v</i> are, they must XOR to 0xa. Well, what are the possible inputs to an SBOX which XOR to 0x5 and whose corresponding SBOX outputs XOR to 0xa? We’ve already calculated them when making the difference distribution table! The calculation was not shown previously (we only saw the one for an SBOX input XOR of 0xb) so let’s see it now:</p>
      <table class="monospaced-table" id="xor-input-output-table-0x5">
        <tr>
          <th><i>x</i></th>
          <th><i>x</i><sup>*</sup></th>
          <th><i>x</i> ⊕ <i>x</i><sup>*</sup></th>
          <th><i>y</i></th>
          <th><i>y</i><sup>*</sup></th>
          <th><i>y</i> ⊕ <i>y</i><sup>*</sup></th>
        </tr>
        <tr>
          <td>0000</td>
          <td>0101</td>
          <td>0101</td>
          <td>1110</td>
          <td>1111</td>
          <td>0001</td>
        </tr>
        <tr>
          <td>0001</td>
          <td>0100</td>
          <td>0101</td>
          <td>0100</td>
          <td>0010</td>
          <td>0110</td>
        </tr>
        <tr>
          <td>0010</td>
          <td>0111</td>
          <td>0101</td>
          <td>1101</td>
          <td>1000</td>
          <td>0101</td>
        </tr>
        <tr class="highlight">
          <td>0011</td>
          <td>0110</td>
          <td>0101</td>
          <td>0001</td>
          <td>1011</td>
          <td>1010</td>
        </tr>
        <tr>
          <td>0100</td>
          <td>0001</td>
          <td>0101</td>
          <td>0010</td>
          <td>0100</td>
          <td>0110</td>
        </tr>
        <tr>
          <td>0101</td>
          <td>0000</td>
          <td>0101</td>
          <td>1111</td>
          <td>1110</td>
          <td>0001</td>
        </tr>
        <tr class="highlight">
          <td>0110</td>
          <td>0011</td>
          <td>0101</td>
          <td>1011</td>
          <td>0001</td>
          <td>1010</td>
        </tr>
        <tr>
          <td>0111</td>
          <td>0010</td>
          <td>0101</td>
          <td>1000</td>
          <td>1101</td>
          <td>0101</td>
        </tr>
        <tr class="highlight">
          <td>1000</td>
          <td>1101</td>
          <td>0101</td>
          <td>0011</td>
          <td>1001</td>
          <td>1010</td>
        </tr>
        <tr>
          <td>1001</td>
          <td>1100</td>
          <td>0101</td>
          <td>1010</td>
          <td>0101</td>
          <td>1111</td>
        </tr>
        <tr>
          <td>1010</td>
          <td>1111</td>
          <td>0101</td>
          <td>0110</td>
          <td>0111</td>
          <td>0001</td>
        </tr>
        <tr>
          <td>1011</td>
          <td>1110</td>
          <td>0101</td>
          <td>1100</td>
          <td>0000</td>
          <td>1100</td>
        </tr>
        <tr>
          <td>1100</td>
          <td>1001</td>
          <td>0101</td>
          <td>0101</td>
          <td>1010</td>
          <td>1111</td>
        </tr>
        <tr class="highlight">
          <td>1101</td>
          <td>1000</td>
          <td>0101</td>
          <td>1001</td>
          <td>0011</td>
          <td>1010</td>
        </tr>
        <tr>
          <td>1110</td>
          <td>1011</td>
          <td>0101</td>
          <td>0000</td>
          <td>1100</td>
          <td>1100</td>
        </tr>
        <tr>
          <td>1111</td>
          <td>1010</td>
          <td>0101</td>
          <td>0111</td>
          <td>0110</td>
          <td>0001</td>
        </tr>
      </table>
      <p>The highlighted rows give us the four possible SBOX input pairs which XOR to 0x5, whose respective outputs XOR to 0xa. With this information, we can update the previous figure:</p>
      <div class="visualization">
        <div class="figure">
          <svg version="1.1" viewBox="51 10 540 290" xmlns="http://www.w3.org/2000/svg" id="toy-dc-unfinished">
  <!-- original viewBox="0 0 600 905" -->

  <!-- Text -->
  <g stroke="black" stroke-width="0.5" id="mid-text">
    <text x="190" y="20">Possible</text>
    <text x="197" y="35">Values</text>
    <text x="310" y="30">XOR</text>
    <text x="395" y="20">Possible</text>
    <text x="402" y="35">Values</text>

    <line x1="180" y1="45" x2="460" y2="45" stroke-width="2" />

    <text x="207" y="65">0x6</text>
    <text x="310" y="65">0x5</text>
    <text x="413" y="65">0x3</text>

    <text x="190" y="130">0x3, 0x6,</text>
    <text x="190" y="144">0x8, 0xd</text>
    <text x="310" y="137">0x5</text>
    <text x="396" y="130">0x6, 0x3,</text>
    <text x="396" y="144">0xd, 0x8</text>

    <text x="190" y="202">0x1, 0xb,</text>
    <text x="190" y="216">0x3, 0x9</text>
    <text x="310" y="209">0xa</text>
    <text x="396" y="202">0xb, 0x1,</text>
    <text x="396" y="216">0x9, 0x3</text>

    <text x="207" y="278">0x4</text>
    <text x="310" y="278">0xa</text>
    <text x="413" y="278">0xe</text>
  </g>


  <!-- Toy 1 -->
  <g stroke="black" stroke-width="2.5">
    <!-- round 1 key input -->
    <g class="x">
      <line x1="90" y1="45" x2="90" y2="80" class="b0" />
      <line x1="110" y1="45" x2="110" y2="80" class="b1 isOne" />
      <line x1="130" y1="45" x2="130" y2="80" class="b2 isOne" />
      <line x1="150" y1="45" x2="150" y2="80" class="b3" />
    </g>

    <!-- round 1 key -->
    <rect x="80" y="80" width="80" height="35" fill="transparent" />

    <!-- round 1 sbox input -->
    <g class="u">
      <line x1="90" y1="115" x2="90" y2="150" class="b0" />
      <line x1="110" y1="115" x2="110" y2="150" class="b1" />
      <line x1="130" y1="115" x2="130" y2="150" class="b2" />
      <line x1="150" y1="115" x2="150" y2="150" class="b3" />
    </g>

    <!-- round 1 sbox -->
    <rect x="80" y="150" width="80" height="35" fill="transparent" />

    <!-- round 2 key input -->
    <g class="v">
      <line x1="90" y1="185" x2="90" y2="220" class="b0" />
      <line x1="110" y1="185" x2="110" y2="220" class="b1" />
      <line x1="130" y1="185" x2="130" y2="220" class="b2" />
      <line x1="150" y1="185" x2="150" y2="220" class="b3" />
    </g>

    <!-- round 2 key -->
    <rect x="80" y="220" width="80" height="35" fill="transparent" />

    <!-- round 2 key output -->
    <g class="y">
      <line x1="90" y1="255" x2="90" y2="290" class="b0" />
      <line x1="110" y1="255" x2="110" y2="290" class="b1 isOne" />
      <line x1="130" y1="255" x2="130" y2="290" class="b2" />
      <line x1="150" y1="255" x2="150" y2="290" class="b3" />
    </g>
  </g>
  <g>
    <!-- K1 -->
    <text x="113" y="103">K</text>
    <text class="sub" x="125" y="107">1</text>
    <!-- K2 -->
    <text x="113" y="243">K</text>
    <text class="sub" x="125" y="247">2</text>

    <!-- x -->
    <text x="50" y="70">x</text>

    <!-- u1 -->
    <text x="50" y="140">u</text>
    <!-- v1 -->
    <text x="50" y="205">v</text>

    <!-- y -->
    <text x="50" y="280">y</text>

    <!-- S -->
    <text x="114" y="175">S</text>
  </g>


  <!-- Toy 2 -->
  <g stroke="black" stroke-width="2.5">
    <!-- round 1 key input -->
    <g class="x">
      <line x1="490" y1="45" x2="490" y2="80" class="b0" />
      <line x1="510" y1="45" x2="510" y2="80" class="b1" />
      <line x1="530" y1="45" x2="530" y2="80" class="b2 isOne" />
      <line x1="550" y1="45" x2="550" y2="80" class="b3 isOne" />
    </g>

    <!-- round 1 key -->
    <rect x="480" y="80" width="80" height="35" fill="transparent" />

    <!-- round 1 sbox input -->
    <g class="u">
      <line x1="490" y1="115" x2="490" y2="150" class="b0" />
      <line x1="510" y1="115" x2="510" y2="150" class="b1" />
      <line x1="530" y1="115" x2="530" y2="150" class="b2" />
      <line x1="550" y1="115" x2="550" y2="150" class="b3" />
    </g>

    <!-- round 1 sbox -->
    <rect x="480" y="150" width="80" height="35" fill="transparent" />

    <!-- round 2 key input -->
    <g class="v">
      <line x1="490" y1="185" x2="490" y2="220" class="b0" />
      <line x1="510" y1="185" x2="510" y2="220" class="b1" />
      <line x1="530" y1="185" x2="530" y2="220" class="b2" />
      <line x1="550" y1="185" x2="550" y2="220" class="b3" />
    </g>

    <!-- round 2 key -->
    <rect x="480" y="220" width="80" height="35" fill="transparent" />

    <!-- round 2 key output -->
    <g class="y">
      <line x1="490" y1="255" x2="490" y2="290" class="b0 isOne" />
      <line x1="510" y1="255" x2="510" y2="290" class="b1 isOne" />
      <line x1="530" y1="255" x2="530" y2="290" class="b2 isOne" />
      <line x1="550" y1="255" x2="550" y2="290" class="b3" />
    </g>
  </g>
  <g>
    <!-- K1 -->
    <text x="513" y="103">K</text>
    <text class="sub" x="525" y="107">1</text>
    <!-- K2 -->
    <text x="513" y="243">K</text>
    <text class="sub" x="525" y="247">2</text>

    <!-- x -->
    <text x="575" y="70">x</text>

    <!-- u1 -->
    <text x="575" y="140">u</text>
    <!-- v1 -->
    <text x="575" y="205">v</text>

    <!-- y -->
    <text x="575" y="280">y</text>

    <!-- S -->
    <text x="514" y="175">S</text>
  </g>
</svg>
        </div>
      </div>
      <p>If we know the value at <i>x</i>, <i>u</i>, <i>v</i>, and <i>y</i>, we can simply calculate the value of the first and second key! By definition, we know:</p>
      <table class="monospaced-table math">
        <tr>
          <td>
            <p><i>x</i> ⊕ <i>k</i><sub>1</sub> = <i>u</i></p>
          </td>                   
        </tr>                     
        <tr>                      
          <td>                    
            <p><i>v</i> ⊕ <i>k</i><sub>2</sub> = <i>y</i></p>
          </td>
        </tr>
      </table>
      <p>Using simple XOR rules we can conclude that:</p>
      <table class="monospaced-table math">
        <tr>
          <td>
            <p><i>k</i><sub>1</sub> = <i>x</i> ⊕ <i>u</i></p>
          </td>                       
        </tr>                                    
        <tr>                                     
          <td>                                   
            <p><i>k</i><sub>2</sub> = <i>v</i> ⊕ <i>y</i></p>
          </td>
        </tr>
      </table>
      <p>Since there are only four possible values of <i>u</i> and <i>v</i>, we’ve narrowed down the possibilities for the two keys from 256 to only 4 (in the table, the subscripts <i>l</i> and <i>r</i> refer to the left and right values in the figure above):</p>
      <table class="monospaced-table" id="toy-keys">
        <tr>
          <th><i>x<sub>l</sub></i></th>
          <th><i>u<sub>l</sub></i></th>
          <th><i>v<sub>l</sub></i></th>
          <th><i>y<sub>l</sub></i></th>
          <th><i>x<sub>r</sub></i></th>
          <th><i>u<sub>r</sub></i></th>
          <th><i>v<sub>r</sub></i></th>
          <th><i>y<sub>r</sub></i></th>
          <th>
            <i>x<sub>l</sub></i> ⊕ <i>u<sub>l</sub></i> =<br/>
            <i>x<sub>r</sub></i> ⊕ <i>u<sub>r</sub></i> =<br/>
            <i>k</i><sub>1</sub>
          </th>
          <th>
            <i>v<sub>l</sub></i> ⊕ <i>y<sub>l</sub></i> =<br/>
            <i>v<sub>r</sub></i> ⊕ <i>y<sub>r</sub></i> =<br/>
            <i>k</i><sub>2</sub>
          </th>
        </tr>
        <tr>
          <td>0x6</td>
          <td>0x3</td>
          <td>0x1</td>
          <td>0x4</td>
          <td>0x3</td>
          <td>0x6</td>
          <td>0xb</td>
          <td>0xe</td>
          <td>0x5</td>
          <td>0x5</td>
        </tr>
        <tr>
          <td>0x6</td>
          <td>0x6</td>
          <td>0xb</td>
          <td>0x4</td>
          <td>0x3</td>
          <td>0x3</td>
          <td>0x1</td>
          <td>0xe</td>
          <td>0x0</td>
          <td>0xf</td>
        </tr>
        <tr>
          <td>0x6</td>
          <td>0x8</td>
          <td>0x3</td>
          <td>0x4</td>
          <td>0x3</td>
          <td>0xd</td>
          <td>0x9</td>
          <td>0xe</td>
          <td>0xe</td>
          <td>0x7</td>
        </tr>
        <tr>
          <td>0x6</td>
          <td>0xd</td>
          <td>0x9</td>
          <td>0x4</td>
          <td>0x3</td>
          <td>0x8</td>
          <td>0x3</td>
          <td>0xe</td>
          <td class="highlight">0xb</td>
          <td class="highlight">0xd</td>
        </tr>
      </table>
    </section>
    <p>You can see that one of the possible key guesses is correct! Remember that we set <i>k</i><sub>1</sub> = 0xb and <i>k</i><sub>2</sub> = 0xd earlier. Had we not known the keys beforehand, we would have had to loop through these 4 possible key combinations and find the keys that will give us the correct ciphertext for a given plaintext.</p>
    <hr/>
    <p>Let’s do a quick review of the steps we took to get here:</p>
    <ul>
      <li>We started by making the difference distribution table for the given SBOX</li>
      <li>We then randomly picked a differential characteristic with a non-zero probability</li>
      <li>We found a plaintext-ciphertext pair which matched that differential characteristic</li>
      <li>Using that good pair we narrowed down the values at <i>u</i> and <i>v</i> to only four possibilities</li>
      <li>Those also narrowed down the possible key combinations to four</li>
      <li>Since we already knew which one was correct, we just picked it out. Had we not known, we would have had to verify all four combinations with some plaintext-ciphertext pairs</li>
    </ul>
    <p>Though the toy cipher served as a great introduction to many of the concepts and vocabulary of differential cryptanalysis, it’s called the <em>toy</em> cipher for a reason. It is so easily broken by brute force that these steps seem unnecessarily complicated. In the next section, you will see a more realistic application of differential cryptanalysis to break a non-trivial cipher.</p>
    <hr/>
    <footer>
      <blockquote>
        <p>Here I pause. If you wish to walk no farther with me, reader, I cannot blame you. It is no easy road.</p>
        <cite>—Wolfe</cite>
      </blockquote>
    </footer>
  </section>
  <section>
    <header>
      <h2>SPN</h2>
      <blockquote>
        <p>Simplicity does not precede complexity, but follows it.</p>
        <cite>—Perlis</cite>
      </blockquote>
    </header>
    <p>This section expands on the knowledge gained in the previous. We will discuss how differential cryptanalysis can be applied to more complicated ciphers which resemble the Advanced Encryption Standard (AES). Though the heart of the method will remain the same, the complexity of these ciphers will require the introduction of some new concepts.</p>
    <section>
      <h3>SPN Definition</h3>
      <p>A substitution-permutation network (SPN) is any kind of cipher which uses both substitution and permutation together with key addition. Because an SPN is so general (it can have any block size, SBOX size, number of rounds, etc.) and because differential cryptanalysis depends a lot on the structure of the cipher, we’ll be focusing on a particular SPN. Nevertheless, these steps could be taken for any kind of SPN.</p>
      <p>We will be using an SPN with a block size of 16 bits. It will have a total of four rounds. Each round, with the exception of the fourth, will consist of the following operations:</p>
      <ol>
        <li>Key addition with a 16 bit key</li>
        <li>We will then consider the 16 bits as 4 nibbles and put each of those nibbles through a 4-bit SBOX</li>
        <li>Lastly we will permutate the block with a 16-bit PBOX</li>
      </ol>
      <p>The fourth round will be the same as the previous except without the permutation (because it actually provides no extra security). We will also end the cipher with one last key addition.</p>
      <p>This means that we will need five 16-bit keys. The total number of keybits we need to break is therefore 80. A simple brutefore is beyond most computers as this means there are 2<sup>80</sup> = 1.21 × 10<sup>24</sup> possible key combinations. It should be apparent that breaking a cipher like this isn’t trivial. At first glance it might even seem very secure, but we will show how we can use differential cryptanalysis to break it easily.</p>
      <p>As with the toy cipher, this SPN is easier to understand if you look to the figure below. Remember that the values underlined with purple can be modified. The labels on the side are similar to the ones for the toy cipher with a few changes: we use subscripts to indicate the round number and a new label <i>w</i> is added for the value after the permutation.</p>
      <div class="visualization" id="spn-visualization">
  <div class="figure">
    <div class="plaintext">
      <span class="nibble1">0100</span>
      <span class="nibble2">1011</span>
      <span class="nibble3">0001</span>
      <span class="nibble4">1101</span>
    </div>
    <svg version="1.1" viewBox="40 45 481 815" xmlns="http://www.w3.org/2000/svg">
  <!-- original viewBox="0 0 600 905" -->
  <g stroke="black" stroke-width="2.5">
    <!-- round 1 key input -->
    <g class="x">
      <line x1="90" y1="45" x2="90" y2="80" class="b0" />
      <line x1="110" y1="45" x2="110" y2="80" class="b1" />
      <line x1="130" y1="45" x2="130" y2="80" class="b2" />
      <line x1="150" y1="45" x2="150" y2="80" class="b3" />

      <line x1="210" y1="45" x2="210" y2="80" class="b4" />
      <line x1="230" y1="45" x2="230" y2="80" class="b5" />
      <line x1="250" y1="45" x2="250" y2="80" class="b6" />
      <line x1="270" y1="45" x2="270" y2="80" class="b7" />

      <line x1="330" y1="45" x2="330" y2="80" class="b8" />
      <line x1="350" y1="45" x2="350" y2="80" class="b9" />
      <line x1="370" y1="45" x2="370" y2="80" class="ba" />
      <line x1="390" y1="45" x2="390" y2="80" class="bb" />

      <line x1="450" y1="45" x2="450" y2="80" class="bc" />
      <line x1="470" y1="45" x2="470" y2="80" class="bd" />
      <line x1="490" y1="45" x2="490" y2="80" class="be" />
      <line x1="510" y1="45" x2="510" y2="80" class="bf" />
    </g>

    <!-- round 1 key -->
    <rect x="80" y="80" width="440" height="35" fill="transparent" />

    <!-- round 1 sbox input -->
    <g class="u1">
      <line x1="90" y1="115" x2="90" y2="150" class="b0" />
      <line x1="110" y1="115" x2="110" y2="150" class="b1" />
      <line x1="130" y1="115" x2="130" y2="150" class="b2" />
      <line x1="150" y1="115" x2="150" y2="150" class="b3" />

      <line x1="210" y1="115" x2="210" y2="150" class="b4" />
      <line x1="230" y1="115" x2="230" y2="150" class="b5" />
      <line x1="250" y1="115" x2="250" y2="150" class="b6" />
      <line x1="270" y1="115" x2="270" y2="150" class="b7" />

      <line x1="330" y1="115" x2="330" y2="150" class="b8" />
      <line x1="350" y1="115" x2="350" y2="150" class="b9" />
      <line x1="370" y1="115" x2="370" y2="150" class="ba" />
      <line x1="390" y1="115" x2="390" y2="150" class="bb" />

      <line x1="450" y1="115" x2="450" y2="150" class="bc" />
      <line x1="470" y1="115" x2="470" y2="150" class="bd" />
      <line x1="490" y1="115" x2="490" y2="150" class="be" />
      <line x1="510" y1="115" x2="510" y2="150" class="bf" />
    </g>

    <!-- round 1 sbox -->
    <rect x="80" y="150" width="80" height="35" fill="transparent" />
    <rect x="200" y="150" width="80" height="35" fill="transparent" />
    <rect x="320" y="150" width="80" height="35" fill="transparent" />
    <rect x="440" y="150" width="80" height="35" fill="transparent" />

    <!-- round 1 pbox -->
    <g class="v1">
      <line x1="90" y1="185" x2="90" y2="270" class="b0 pbox" />
      <line x1="110" y1="185" x2="210" y2="270" class="b1 pbox" />
      <line x1="130" y1="185" x2="330" y2="270" class="b2 pbox" />
      <line x1="150" y1="185" x2="450" y2="270" class="b3 pbox" />

      <line x1="210" y1="185" x2="110" y2="270" class="b4 pbox" />
      <line x1="230" y1="185" x2="230" y2="270" class="b5 pbox" />
      <line x1="250" y1="185" x2="350" y2="270" class="b6 pbox" />
      <line x1="270" y1="185" x2="470" y2="270" class="b7 pbox" />

      <line x1="330" y1="185" x2="130" y2="270" class="b8 pbox" />
      <line x1="350" y1="185" x2="250" y2="270" class="b9 pbox" />
      <line x1="370" y1="185" x2="370" y2="270" class="ba pbox" />
      <line x1="390" y1="185" x2="490" y2="270" class="bb pbox" />

      <line x1="450" y1="185" x2="150" y2="270" class="bc pbox" />
      <line x1="470" y1="185" x2="270" y2="270" class="bd pbox" />
      <line x1="490" y1="185" x2="390" y2="270" class="be pbox" />
      <line x1="510" y1="185" x2="510" y2="270" class="bf pbox" />
    </g>

    <!-- round 2 key -->
    <rect x="80" y="270" width="440" height="35" fill="transparent" />

    <!-- round 2 sbox input -->
    <g class="u2">
      <line x1="90" y1="305" x2="90" y2="340" class="b0" />
      <line x1="110" y1="305" x2="110" y2="340" class="b1" />
      <line x1="130" y1="305" x2="130" y2="340" class="b2" />
      <line x1="150" y1="305" x2="150" y2="340" class="b3" />

      <line x1="210" y1="305" x2="210" y2="340" class="b4" />
      <line x1="230" y1="305" x2="230" y2="340" class="b5" />
      <line x1="250" y1="305" x2="250" y2="340" class="b6" />
      <line x1="270" y1="305" x2="270" y2="340" class="b7" />

      <line x1="330" y1="305" x2="330" y2="340" class="b8" />
      <line x1="350" y1="305" x2="350" y2="340" class="b9" />
      <line x1="370" y1="305" x2="370" y2="340" class="ba" />
      <line x1="390" y1="305" x2="390" y2="340" class="bb" />

      <line x1="450" y1="305" x2="450" y2="340" class="bc" />
      <line x1="470" y1="305" x2="470" y2="340" class="bd" />
      <line x1="490" y1="305" x2="490" y2="340" class="be" />
      <line x1="510" y1="305" x2="510" y2="340" class="bf" />
    </g>

    <!-- round 2 sbox -->
    <rect x="80" y="340" width="80" height="35" fill="transparent" />
    <rect x="200" y="340" width="80" height="35" fill="transparent" />
    <rect x="320" y="340" width="80" height="35" fill="transparent" />
    <rect x="440" y="340" width="80" height="35" fill="transparent" />

    <!-- round 2 pbox -->
    <g class="v2">
      <line x1="90" y1="375" x2="90" y2="460" class="b0 pbox" />
      <line x1="110" y1="375" x2="210" y2="460" class="b1 pbox" />
      <line x1="130" y1="375" x2="330" y2="460" class="b2 pbox" />
      <line x1="150" y1="375" x2="450" y2="460" class="b3 pbox" />

      <line x1="210" y1="375" x2="110" y2="460" class="b4 pbox" />
      <line x1="230" y1="375" x2="230" y2="460" class="b5 pbox" />
      <line x1="250" y1="375" x2="350" y2="460" class="b6 pbox" />
      <line x1="270" y1="375" x2="470" y2="460" class="b7 pbox" />

      <line x1="330" y1="375" x2="130" y2="460" class="b8 pbox" />
      <line x1="350" y1="375" x2="250" y2="460" class="b9 pbox" />
      <line x1="370" y1="375" x2="370" y2="460" class="ba pbox" />
      <line x1="390" y1="375" x2="490" y2="460" class="bb pbox" />

      <line x1="450" y1="375" x2="150" y2="460" class="bc pbox" />
      <line x1="470" y1="375" x2="270" y2="460" class="bd pbox" />
      <line x1="490" y1="375" x2="390" y2="460" class="be pbox" />
      <line x1="510" y1="375" x2="510" y2="460" class="bf pbox" />
    </g>

    <!-- round 3 key -->
    <rect x="80" y="460" width="440" height="35" fill="transparent" />

    <!-- round 3 sbox input -->
    <g class="u3">
      <line x1="90" y1="495" x2="90" y2="530" class="b0" />
      <line x1="110" y1="495" x2="110" y2="530" class="b1" />
      <line x1="130" y1="495" x2="130" y2="530" class="b2" />
      <line x1="150" y1="495" x2="150" y2="530" class="b3" />

      <line x1="210" y1="495" x2="210" y2="530" class="b4" />
      <line x1="230" y1="495" x2="230" y2="530" class="b5" />
      <line x1="250" y1="495" x2="250" y2="530" class="b6" />
      <line x1="270" y1="495" x2="270" y2="530" class="b7" />

      <line x1="330" y1="495" x2="330" y2="530" class="b8" />
      <line x1="350" y1="495" x2="350" y2="530" class="b9" />
      <line x1="370" y1="495" x2="370" y2="530" class="ba" />
      <line x1="390" y1="495" x2="390" y2="530" class="bb" />

      <line x1="450" y1="495" x2="450" y2="530" class="bc" />
      <line x1="470" y1="495" x2="470" y2="530" class="bd" />
      <line x1="490" y1="495" x2="490" y2="530" class="be" />
      <line x1="510" y1="495" x2="510" y2="530" class="bf" />
    </g>

    <!-- round 3 sbox -->
    <rect x="80" y="530" width="80" height="35" fill="transparent" />
    <rect x="200" y="530" width="80" height="35" fill="transparent" />
    <rect x="320" y="530" width="80" height="35" fill="transparent" />
    <rect x="440" y="530" width="80" height="35" fill="transparent" />

    <!-- round 3 pbox -->
    <g class="v3">
      <line x1="90" y1="565" x2="90" y2="650" class="b0 pbox" />
      <line x1="110" y1="565" x2="210" y2="650" class="b1 pbox" />
      <line x1="130" y1="565" x2="330" y2="650" class="b2 pbox" />
      <line x1="150" y1="565" x2="450" y2="650" class="b3 pbox" />

      <line x1="210" y1="565" x2="110" y2="650" class="b4 pbox" />
      <line x1="230" y1="565" x2="230" y2="650" class="b5 pbox" />
      <line x1="250" y1="565" x2="350" y2="650" class="b6 pbox" />
      <line x1="270" y1="565" x2="470" y2="650" class="b7 pbox" />

      <line x1="330" y1="565" x2="130" y2="650" class="b8 pbox" />
      <line x1="350" y1="565" x2="250" y2="650" class="b9 pbox" />
      <line x1="370" y1="565" x2="370" y2="650" class="ba pbox" />
      <line x1="390" y1="565" x2="490" y2="650" class="bb pbox" />

      <line x1="450" y1="565" x2="150" y2="650" class="bc pbox" />
      <line x1="470" y1="565" x2="270" y2="650" class="bd pbox" />
      <line x1="490" y1="565" x2="390" y2="650" class="be pbox" />
      <line x1="510" y1="565" x2="510" y2="650" class="bf pbox" />
    </g>

    <!-- round 4 key -->
    <rect x="80" y="650" width="440" height="35" fill="transparent" />

    <!-- round 4 sbox input -->
    <g class="u4">
      <line x1="90" y1="685" x2="90" y2="720" class="b0" />
      <line x1="110" y1="685" x2="110" y2="720" class="b1" />
      <line x1="130" y1="685" x2="130" y2="720" class="b2" />
      <line x1="150" y1="685" x2="150" y2="720" class="b3" />

      <line x1="210" y1="685" x2="210" y2="720" class="b4" />
      <line x1="230" y1="685" x2="230" y2="720" class="b5" />
      <line x1="250" y1="685" x2="250" y2="720" class="b6" />
      <line x1="270" y1="685" x2="270" y2="720" class="b7" />

      <line x1="330" y1="685" x2="330" y2="720" class="b8" />
      <line x1="350" y1="685" x2="350" y2="720" class="b9" />
      <line x1="370" y1="685" x2="370" y2="720" class="ba" />
      <line x1="390" y1="685" x2="390" y2="720" class="bb" />

      <line x1="450" y1="685" x2="450" y2="720" class="bc" />
      <line x1="470" y1="685" x2="470" y2="720" class="bd" />
      <line x1="490" y1="685" x2="490" y2="720" class="be" />
      <line x1="510" y1="685" x2="510" y2="720" class="bf" />
    </g>

    <!-- round 4 sbox -->
    <rect x="80" y="720" width="80" height="35" fill="transparent" />
    <rect x="200" y="720" width="80" height="35" fill="transparent" />
    <rect x="320" y="720" width="80" height="35" fill="transparent" />
    <rect x="440" y="720" width="80" height="35" fill="transparent" />

    <!-- round 5 key input -->
    <g class="v4">
      <line x1="90" y1="755" x2="90" y2="790" class="b0" />
      <line x1="110" y1="755" x2="110" y2="790" class="b1" />
      <line x1="130" y1="755" x2="130" y2="790" class="b2" />
      <line x1="150" y1="755" x2="150" y2="790" class="b3" />

      <line x1="210" y1="755" x2="210" y2="790" class="b4" />
      <line x1="230" y1="755" x2="230" y2="790" class="b5" />
      <line x1="250" y1="755" x2="250" y2="790" class="b6" />
      <line x1="270" y1="755" x2="270" y2="790" class="b7" />

      <line x1="330" y1="755" x2="330" y2="790" class="b8" />
      <line x1="350" y1="755" x2="350" y2="790" class="b9" />
      <line x1="370" y1="755" x2="370" y2="790" class="ba" />
      <line x1="390" y1="755" x2="390" y2="790" class="bb" />

      <line x1="450" y1="755" x2="450" y2="790" class="bc" />
      <line x1="470" y1="755" x2="470" y2="790" class="bd" />
      <line x1="490" y1="755" x2="490" y2="790" class="be" />
      <line x1="510" y1="755" x2="510" y2="790" class="bf" />
    </g>

    <!-- round 5 key -->
    <rect x="80" y="790" width="440" height="35" fill="transparent" />

    <!-- round 5 key output -->
    <g class="y">
      <line x1="90" y1="825" x2="90" y2="860" class="b0" />
      <line x1="110" y1="825" x2="110" y2="860" class="b1" />
      <line x1="130" y1="825" x2="130" y2="860" class="b2" />
      <line x1="150" y1="825" x2="150" y2="860" class="b3" />

      <line x1="210" y1="825" x2="210" y2="860" class="b4" />
      <line x1="230" y1="825" x2="230" y2="860" class="b5" />
      <line x1="250" y1="825" x2="250" y2="860" class="b6" />
      <line x1="270" y1="825" x2="270" y2="860" class="b7" />

      <line x1="330" y1="825" x2="330" y2="860" class="b8" />
      <line x1="350" y1="825" x2="350" y2="860" class="b9" />
      <line x1="370" y1="825" x2="370" y2="860" class="ba" />
      <line x1="390" y1="825" x2="390" y2="860" class="bb" />

      <line x1="450" y1="825" x2="450" y2="860" class="bc" />
      <line x1="470" y1="825" x2="470" y2="860" class="bd" />
      <line x1="490" y1="825" x2="490" y2="860" class="be" />
      <line x1="510" y1="825" x2="510" y2="860" class="bf" />
    </g>
  </g>
  <g>
    <!-- K1 -->
    <text x="293" y="103">K</text>
    <text class="sub" x="305" y="107">1</text>
    <!-- K2 -->
    <text x="293" y="293">K</text>
    <text class="sub" x="305" y="297">2</text>
    <!-- K3 -->
    <text x="293" y="483">K</text>
    <text class="sub" x="305" y="487">3</text>
    <!-- K4 -->
    <text x="293" y="673">K</text>
    <text class="sub" x="305" y="677">4</text>
    <!-- K5 -->
    <text x="293" y="813">K</text>
    <text class="sub" x="305" y="817">5</text>

    <!-- x -->
    <text x="40" y="70">x</text>

    <!-- u1 -->
    <text x="40" y="140">u</text>
    <text class="sub" x="53" y="145">1</text>
    <!-- v1 -->
    <text x="40" y="205">v</text>
    <text class="sub" x="53" y="210">1</text>
    <!-- w1 -->
    <text x="40" y="260">w</text>
    <text class="sub" x="53" y="265">1</text>

    <!-- u2 -->
    <text x="40" y="330">u</text>
    <text class="sub" x="53" y="335">2</text>
    <!-- v2 -->
    <text x="40" y="395">v</text>
    <text class="sub" x="53" y="400">2</text>
    <!-- w2 -->
    <text x="40" y="450">w</text>
    <text class="sub" x="53" y="455">2</text>

    <!-- u3 -->
    <text x="40" y="520">u</text>
    <text class="sub" x="53" y="525">3</text>
    <!-- v3 -->
    <text x="40" y="585">v</text>
    <text class="sub" x="53" y="590">3</text>
    <!-- w3 -->
    <text x="40" y="640">w</text>
    <text class="sub" x="53" y="645">3</text>

    <!-- u4 -->
    <text x="40" y="710">u</text>
    <text class="sub" x="53" y="715">4</text>
    <!-- v4 -->
    <text x="40" y="780">v</text>
    <text class="sub" x="53" y="785">4</text>

    <!-- y -->
    <text x="40" y="850">y</text>

    <!-- S -->
    <text x="114" y="175">S</text>
    <text x="234" y="175">S</text>
    <text x="354" y="175">S</text>
    <text x="474" y="175">S</text>

    <text x="114" y="365">S</text>
    <text x="234" y="365">S</text>
    <text x="354" y="365">S</text>
    <text x="474" y="365">S</text>

    <text x="114" y="555">S</text>
    <text x="234" y="555">S</text>
    <text x="354" y="555">S</text>
    <text x="474" y="555">S</text>

    <text x="114" y="745">S</text>
    <text x="234" y="745">S</text>
    <text x="354" y="745">S</text>
    <text x="474" y="745">S</text>
  </g>
</svg>
    <div class="ciphertext">
      <span class="nibble1"></span>
      <span class="nibble2"></span>
      <span class="nibble3"></span>
      <span class="nibble4"></span>
    </div>
  </div>
  <div class="controls">
    <table class="sbox">
      <tr>
        <th colspan="17">SBOX</th>
      </tr>
      <tr>
        <th>Input:</th>
        <td>0</td>
        <td>1</td>
        <td>2</td>
        <td>3</td>
        <td>4</td>
        <td>5</td>
        <td>6</td>
        <td>7</td>
        <td>8</td>
        <td>9</td>
        <td>a</td>
        <td>b</td>
        <td>c</td>
        <td>d</td>
        <td>e</td>
        <td>f</td>
      </tr>
      <tr>
        <th>Output:</th>
        <td><input value='e' /></td>
        <td><input value='4' /></td>
        <td><input value='d' /></td>
        <td><input value='1' /></td>
        <td><input value='2' /></td>
        <td><input value='f' /></td>
        <td><input value='b' /></td>
        <td><input value='8' /></td>
        <td><input value='3' /></td>
        <td><input value='a' /></td>
        <td><input value='6' /></td>
        <td><input value='c' /></td>
        <td><input value='5' /></td>
        <td><input value='9' /></td>
        <td><input value='0' /></td>
        <td><input value='7' /></td>
      </tr>
    </table>
    <table class="pbox">
      <tr>
        <th colspan="17">PBOX</th>
      </tr>
      <tr>
        <th>Input:</th>
        <td>0</td>
        <td>1</td>
        <td>2</td>
        <td>3</td>
        <td>4</td>
        <td>5</td>
        <td>6</td>
        <td>7</td>
        <td>8</td>
        <td>9</td>
        <td>a</td>
        <td>b</td>
        <td>c</td>
        <td>d</td>
        <td>e</td>
        <td>f</td>
      </tr>
      <tr>
        <th>Output:</th>
        <td><input value='0' /></td>
        <td><input value='4' /></td>
        <td><input value='8' /></td>
        <td><input value='c' /></td>
        <td><input value='1' /></td>
        <td><input value='5' /></td>
        <td><input value='9' /></td>
        <td><input value='d' /></td>
        <td><input value='2' /></td>
        <td><input value='6' /></td>
        <td><input value='a' /></td>
        <td><input value='e' /></td>
        <td><input value='3' /></td>
        <td><input value='7' /></td>
        <td><input value='b' /></td>
        <td><input value='f' /></td>
      </tr>
    </table>
    <table class="plaintext-key-ciphertext">
      <tr>
        <td><b>Plaintext:</b></td>
        <td>0x<input class="plaintext-input" value='4b1d' /></td>
      </tr>
      <tr>
        <td><b>Key 1:</b></td>
        <td>0x<input class="key1-input" value='1a6d' /></td>
      </tr>
      <tr>
        <td><b>Key 2:</b></td>
        <td>0x<input class="key2-input" value='2ac2' /></td>
      </tr>
      <tr>
        <td><b>Key 3:</b></td>
        <td>0x<input class="key3-input" value='452f' /></td>
      </tr>
      <tr>
        <td><b>Key 4:</b></td>
        <td>0x<input class="key4-input" value='6ff1' /></td>
      </tr>
      <tr>
        <td><b>Key 5:</b></td>
        <td>0x<input class="key5-input" value='b520' /></td>
      </tr>
      <tr>
        <td><b>Ciphertext:</b></td>
        <td class="ciphertext-output"></td>
      </tr>
    </table>
    <div class="error-messages">
      <p class="pbox-error" style="display: none;">PBOX is invalid. Make sure to only include hexadecimal digits (0 to f) and that the PBOX is one-to-one (i.e. there are no duplicates in the output).</p>
      <p class="sbox-error" style="display: none;">SBOX is invalid. Make sure to only include hexadecimal digits (0 to f) and that the SBOX is one-to-one (i.e. there are no duplicates in the output).</p>
    </div>
  </div>
  <script src="js/spn-visualization.js"></script>
</div>
    </section>
    <section>
      <h3>Differential Cryptanalysis of an SPN</h3>
      <p>This section is partly based on Howard M. Heys’s “A Tutorial on Linear and Differential Cryptanalysis” {cite(heys)}.</p>
      <p>We begin by defining the SBOX and PBOX for the cipher. We’ll keep the SBOX from the previous section and the default PBOX from the figure above.</p>
      <table class="monospaced-table" id="substitution">
        <tr>
          <th colspan="17">SBOX</th>
        </tr>
        <tr>
          <th>Input:</th>
          <td>0</td>
          <td>1</td>
          <td>2</td>
          <td>3</td>
          <td>4</td>
          <td>5</td>
          <td>6</td>
          <td>7</td>
          <td>8</td>
          <td>9</td>
          <td>a</td>
          <td>b</td>
          <td>c</td>
          <td>d</td>
          <td>e</td>
          <td>f</td>
        </tr>
        <tr>
          <th>Output:</th>
          <td>e</td>
          <td>4</td>
          <td>d</td>
          <td>1</td>
          <td>2</td>
          <td>f</td>
          <td>b</td>
          <td>8</td>
          <td>3</td>
          <td>a</td>
          <td>6</td>
          <td>c</td>
          <td>5</td>
          <td>9</td>
          <td>0</td>
          <td>7</td>
        </tr>
      </table>
      <table class="monospaced-table" id="permutation-16">
        <tr>
          <th colspan="17">PBOX</th>
        </tr>
        <tr>
          <th>Input:</th>
          <td>0</td>
          <td>1</td>
          <td>2</td>
          <td>3</td>
          <td>4</td>
          <td>5</td>
          <td>6</td>
          <td>7</td>
          <td>8</td>
          <td>9</td>
          <td>a</td>
          <td>b</td>
          <td>c</td>
          <td>d</td>
          <td>e</td>
          <td>f</td>
        </tr>
        <tr>
          <th>Output:</th>
          <td>0</td>
          <td>4</td>
          <td>8</td>
          <td>c</td>
          <td>1</td>
          <td>5</td>
          <td>9</td>
          <td>d</td>
          <td>2</td>
          <td>6</td>
          <td>a</td>
          <td>e</td>
          <td>3</td>
          <td>7</td>
          <td>b</td>
          <td>f</td>
        </tr>
      </table>
      <p>The first step, just like before, is to calculate the difference distribution table. Since we’re using the same SBOX, it remains unchanged from the previous section.</p>
      <table class="monospaced-table" id="difference-distribution-table">
        <tr>
          <th>Input</th>
          <th colspan="16">Output XOR</th>
        </tr>
        <tr>
          <th>XOR</th>
          <th>0</th>
          <th>1</th>
          <th>2</th>
          <th>3</th>
          <th>4</th>
          <th>5</th>
          <th>6</th>
          <th>7</th>
          <th>8</th>
          <th>9</th>
          <th>a</th>
          <th>b</th>
          <th>c</th>
          <th>d</th>
          <th>e</th>
          <th>f</th>
        </tr>
        <tr>
          <th>0</th>
          <td class="highlight">16</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
        </tr>
        <tr>
          <th>1</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">4</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
        </tr>
        <tr>
          <th>2</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">6</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
        </tr>
        <tr>
          <th>3</th>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
        </tr>
        <tr>
          <th>4</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">6</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
        </tr>
        <tr>
          <th>5</th>
          <td>0</td>
          <td class="highlight">4</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
        </tr>
        <tr>
          <th>6</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
        </tr>
        <tr>
          <th>7</th>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
        </tr>
        <tr>
          <th>8</th>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
        </tr>
        <tr>
          <th>9</th>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
        </tr>
        <tr>
          <th>a</th>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">6</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td>0</td>
        </tr>
        <tr>
          <th>b</th>
          <td>0</td>
          <td>0</td>
          <td class="highlight">8</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
        </tr>
        <tr>
          <th>c</th>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">6</td>
          <td>0</td>
          <td>0</td>
        </tr>
        <tr>
          <th>d</th>
          <td>0</td>
          <td class="highlight">4</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
        </tr>
        <tr>
          <th>e</th>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td class="highlight">4</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">6</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
        </tr>
        <tr>
          <th>f</th>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">6</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">4</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
          <td>0</td>
          <td class="highlight">2</td>
          <td>0</td>
        </tr>
      </table>
      <hr/>
      <p>Before we move on we need to discuss permutation. We’ve considered what happens to the XOR of two plaintexts when they go through key addition (it doesn’t change) and when they go through substitution (we can guess it based on the probabilities in the difference distribution table). However, we have not considered what happens when they go through permutation.</p>
      <p>Let’s consider two plaintexts:</p>
      <table class="monospaced-table math">
        <tr>
          <td>
            <p><i>x</i> = 1100 1110 1001 1011</p>
          </td>
        </tr>
        <tr>
          <td>
            <p><i>x</i><sup>*</sup> = 0011 1110 0101 0111</p>
          </td>
        </tr>
        <tr>
          <td>
            <p><i>x</i> ⊕ <i>x</i><sup>*</sup> = 1111 0000 1100 1100</p>
          </td>
        </tr>
      </table>
      <p>Now let’s send both of these plaintexts through the PBOX:</p>
      <table class="monospaced-table math">
        <tr>
          <td>
            <p>permutate(<i>x</i>) = 1111 1100 0101 0011</p>
          </td>
        </tr>
        <tr>
          <td>
            <p>permutate(<i>x</i><sup>*</sup>) = 0100 0111 1101 1011</p>
          </td>
        </tr>
        <tr>
          <td>
            <p>permutate(<i>x</i>) ⊕ permutate(<i>x</i><sup>*</sup>) = <span class="highlight">1011 1011 1000 1000</span></p>
          </td>
        </tr>
      </table>
      <p>We can see that, unlike key addition, the XOR value before the permutation operation is different than the XOR of the value after the permutation, which could make things difficult. However, what happens if we send the XOR value before the permutation through the PBOX?</p>
      <table class="monospaced-table math">
        <tr>
          <td>
            <p>permutate(<i>x</i> ⊕ <i>x</i><sup>*</sup>) = permutate(1111 0000 1100 1100) = <span class="highlight">1011 1011 1000 0001</span></p>
          </td>
        </tr>
      </table>
      <p>You should see that both permutate(<i>x</i>) ⊕ permutate(<i>x</i><sup>*</sup>) and permutate(<i>x</i> ⊕ <i>x</i><sup>*</sup>) come out to the same value.</p>
      <p>For some intuition as to why this is true, notice that both of the plaintexts will travel through the same PBOX. If their XOR is 1 at some bit position, it will remain 1 after applying the permutation. It will just move to a different bit position determined by the PBOX. The same logic applies for when their XOR is 0. Therefore, while the XOR doesn’t remain the same, if we know the input XOR (which, remember, we can guess with significant certainty) we can predict the output XOR with 100% certainty by simply putting the XOR through the permutation. One way of writing this more mathematically is:</p>
      <table class="monospaced-table math">
        <tr>
          <td>
            <p>permutate(<i>x</i>) ⊕ permutate(<i>x</i><sup>*</sup>) = permutate(<i>x</i> ⊕ <i>x</i><sup>*</sup>)</p>
          </td>                   
        </tr>                     
      </table>
      <p>The significance of this might not be immediately obvious, but remember that the actual values of <i>x</i> and <i>x</i><sup>*</sup> are essentially impossible to guess, which makes computing permutate(<i>x</i>) ⊕ permutate(<i>x</i><sup>*</sup>) difficult. The value of <i>x</i> ⊕ <i>x</i><sup>*</sup>, on the other hand, is what we’ve been keeping track of this whole time! The PBOX, like the SBOX, is public knowledge so computing permutate(<i>x</i> ⊕ <i>x</i><sup>*</sup>) is very easy.</p>
      <hr/>
      <p>Now that we have discussed all three components let’s quickly review how the XOR interacts with them:</p>
      <ul>
        <li>Key addition: the XOR of two plaintexts <em>does not</em> change over key addition. We can therefore predict the output XOR with 100% certainty.</li>
        <li>Substitution: the XOR of two plaintext <em>does</em> change over substitution. However, it does so probabilistically based on the input XOR and the difference distribution table of the SBOX, which gives us some ability to predict it.</li>
        <li>Permutation: the XOR of two plaintext <em>does</em> change over permutation. However, we can predict it with 100% certainty by simply sending the input XOR through the PBOX.</li>
      </ul>
      <hr/>
    </section>
  </section>
  <section>
    <header>
      <h2>Modern Cryptography</h2>
      <blockquote>
        <p>I have said enough to convince you that ciphers of this nature are readily soluble, and to give you some insight into the rationale of their development. But be assured that the specimen before us appertains to the very simplest species of cryptograph.</p>
        <cite>—Poe</cite>
      </blockquote>
    </header>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
  </section>
  <section>
    <h2>Bibliography</h2>
    <ol id="bibliography">
      <li id="biham">Biham, Eli and Adi Shamir. “Differential Cryptanalysis of DES-like Cryptosystems.” <i>Journal of Cryptology</i> 4, no. 1 (January 1991): 3–72. https://doi.org/10.1007/BF00630563.</li>
      <li id="coppersmith">Coppersmith, Don. “The Data Encryption Standard (DES) and its strength against attacks” <i>IBM Journal of Research and Development</i> 38, no. 3 (May 1994): 243–250. https://doi.org/10.1147/rd.383.0243.</li>
      <li id="heys">Heys, Howard M. “A Tutorial on Linear and Differential Cryptanalysis.” <i>Cryptologia</i> 26, no. 3 (July 2002): 189–221. https://doi.org/10.1080/0161-110291890885.</li>
      <li id="king">King, Jon. “Differential Cryptanalysis Tutorial.” The Amazing King. http://theamazingking.com/crypto-diff.php.</li>
      <li id="stinson">Stinson, Douglas R. <i>Cryptography: Theory and Practice</i>. Chapman and Hall/CRC, 2006.</li>
    </ol>
  </section>
</section>
<script src="js/generate-section-numbers.js"></script>
<script src="js/generate-citation-numbers.js"></script>
<script src="js/generate-toc.js"></script>
  </body>
</html>
