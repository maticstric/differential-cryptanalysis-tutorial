<svg version="1.1" viewBox="40 15 963 845" xmlns="http://www.w3.org/2000/svg" id="diff-trail">
  <!-- original viewBox="0 0 600 905" -->

  <!-- Text -->
  <g stroke="black" stroke-width="0.5">
    <text x="102" y="30">0xb</text>
    <text x="222" y="30">0x0</text>
    <text x="342" y="30">0xb</text>
    <text x="462" y="30">0x0</text>

    <text x="640" y="30">XOR</text>
    <text x="800" y="30">Probability</text>

    <line x1="580" y1="45" x2="995" y2="45" stroke-width="3" />

    <!-- u1 -->
    <text x="623" y="140">0xb0b0</text>
    <text x="860" y="140">1</text>
    <!-- v1 -->
    <text x="623" y="205">0x2020</text>
    <text x="747" y="205">1 × 0.5 × 0.5 = 0.25</text>
    <!-- w1 -->
    <text x="623" y="250">0x00a0</text>
    <text x="844" y="250">0.25</text>

    <!-- u2 -->
    <text x="623" y="330">0x00a0</text>
    <text x="844" y="330">0.25</text>
    <!-- v2 -->
    <text x="623" y="395">0x0080</text>
    <text x="747" y="395">0.25 × 0.375 ≈ 0.094</text>
    <!-- w2 -->
    <text x="623" y="450">0x2000</text>
    <text x="837" y="450">0.094</text>

    <!-- u3 -->
    <text x="623" y="520">0x2000</text>
    <text x="837" y="520">0.094</text>
    <!-- v3 -->
    <text x="623" y="585">0x5000</text>
    <text x="740" y="585">0.094 × 0.375 ≈ 0.035</text>
    <!-- w3 -->
    <text x="623" y="640">0x0808</text>
    <text x="837" y="640">0.035</text>

    <!-- u4 -->
    <text x="623" y="710">0x0808</text>
    <text x="837" y="710">0.035</text>
  </g>

  <g stroke="black" stroke-width="2.5">
    <!-- round 1 key input -->
    <g class="x">
      <line x1="90" y1="45" x2="90" y2="80" class="b0 isOne" />
      <line x1="110" y1="45" x2="110" y2="80" class="b1" />
      <line x1="130" y1="45" x2="130" y2="80" class="b2 isOne" />
      <line x1="150" y1="45" x2="150" y2="80" class="b3 isOne" />

      <line x1="210" y1="45" x2="210" y2="80" class="b4" />
      <line x1="230" y1="45" x2="230" y2="80" class="b5" />
      <line x1="250" y1="45" x2="250" y2="80" class="b6" />
      <line x1="270" y1="45" x2="270" y2="80" class="b7" />

      <line x1="330" y1="45" x2="330" y2="80" class="b8 isOne" />
      <line x1="350" y1="45" x2="350" y2="80" class="b9" />
      <line x1="370" y1="45" x2="370" y2="80" class="ba isOne" />
      <line x1="390" y1="45" x2="390" y2="80" class="bb isOne" />

      <line x1="450" y1="45" x2="450" y2="80" class="bc" />
      <line x1="470" y1="45" x2="470" y2="80" class="bd" />
      <line x1="490" y1="45" x2="490" y2="80" class="be" />
      <line x1="510" y1="45" x2="510" y2="80" class="bf" />
    </g>

    <!-- round 1 key -->
    <rect x="80" y="80" width="440" height="35" fill="transparent" />

    <!-- round 1 sbox input -->
    <g class="u1">
      <line x1="90" y1="115" x2="90" y2="150" class="b0 isOne" />
      <line x1="110" y1="115" x2="110" y2="150" class="b1" />
      <line x1="130" y1="115" x2="130" y2="150" class="b2 isOne" />
      <line x1="150" y1="115" x2="150" y2="150" class="b3 isOne" />

      <line x1="210" y1="115" x2="210" y2="150" class="b4" />
      <line x1="230" y1="115" x2="230" y2="150" class="b5" />
      <line x1="250" y1="115" x2="250" y2="150" class="b6" />
      <line x1="270" y1="115" x2="270" y2="150" class="b7" />

      <line x1="330" y1="115" x2="330" y2="150" class="b8 isOne" />
      <line x1="350" y1="115" x2="350" y2="150" class="b9" />
      <line x1="370" y1="115" x2="370" y2="150" class="ba isOne" />
      <line x1="390" y1="115" x2="390" y2="150" class="bb isOne" />

      <line x1="450" y1="115" x2="450" y2="150" class="bc" />
      <line x1="470" y1="115" x2="470" y2="150" class="bd" />
      <line x1="490" y1="115" x2="490" y2="150" class="be" />
      <line x1="510" y1="115" x2="510" y2="150" class="bf" />
    </g>

    <!-- round 1 sbox -->
    <rect x="80" y="150" width="80" height="35" fill="transparent" />
    <rect x="200" y="150" width="80" height="35" fill="transparent" />
    <rect x="320" y="150" width="80" height="35" fill="transparent" />
    <rect x="440" y="150" width="80" height="35" fill="transparent" />

    <!-- round 1 pbox -->
    <g class="v1">
      <line x1="90" y1="185" x2="90" y2="270" class="b0 pbox" />
      <line x1="110" y1="185" x2="210" y2="270" class="b1 pbox" />
      <line x1="130" y1="185" x2="330" y2="270" class="b2 pbox isOne" />
      <line x1="150" y1="185" x2="450" y2="270" class="b3 pbox" />

      <line x1="210" y1="185" x2="110" y2="270" class="b4 pbox" />
      <line x1="230" y1="185" x2="230" y2="270" class="b5 pbox" />
      <line x1="250" y1="185" x2="350" y2="270" class="b6 pbox" />
      <line x1="270" y1="185" x2="470" y2="270" class="b7 pbox" />

      <line x1="330" y1="185" x2="130" y2="270" class="b8 pbox" />
      <line x1="350" y1="185" x2="250" y2="270" class="b9 pbox" />
      <line x1="370" y1="185" x2="370" y2="270" class="ba pbox isOne" />
      <line x1="390" y1="185" x2="490" y2="270" class="bb pbox" />

      <line x1="450" y1="185" x2="150" y2="270" class="bc pbox" />
      <line x1="470" y1="185" x2="270" y2="270" class="bd pbox" />
      <line x1="490" y1="185" x2="390" y2="270" class="be pbox" />
      <line x1="510" y1="185" x2="510" y2="270" class="bf pbox" />
    </g>

    <!-- round 2 key -->
    <rect x="80" y="270" width="440" height="35" fill="transparent" />

    <!-- round 2 sbox input -->
    <g class="u2">
      <line x1="90" y1="305" x2="90" y2="340" class="b0" />
      <line x1="110" y1="305" x2="110" y2="340" class="b1" />
      <line x1="130" y1="305" x2="130" y2="340" class="b2" />
      <line x1="150" y1="305" x2="150" y2="340" class="b3" />

      <line x1="210" y1="305" x2="210" y2="340" class="b4" />
      <line x1="230" y1="305" x2="230" y2="340" class="b5" />
      <line x1="250" y1="305" x2="250" y2="340" class="b6" />
      <line x1="270" y1="305" x2="270" y2="340" class="b7" />

      <line x1="330" y1="305" x2="330" y2="340" class="b8 isOne" />
      <line x1="350" y1="305" x2="350" y2="340" class="b9" />
      <line x1="370" y1="305" x2="370" y2="340" class="ba isOne" />
      <line x1="390" y1="305" x2="390" y2="340" class="bb" />

      <line x1="450" y1="305" x2="450" y2="340" class="bc" />
      <line x1="470" y1="305" x2="470" y2="340" class="bd" />
      <line x1="490" y1="305" x2="490" y2="340" class="be" />
      <line x1="510" y1="305" x2="510" y2="340" class="bf" />
    </g>

    <!-- round 2 sbox -->
    <rect x="80" y="340" width="80" height="35" fill="transparent" />
    <rect x="200" y="340" width="80" height="35" fill="transparent" />
    <rect x="320" y="340" width="80" height="35" fill="transparent" />
    <rect x="440" y="340" width="80" height="35" fill="transparent" />

    <!-- round 2 pbox -->
    <g class="v2">
      <line x1="90" y1="375" x2="90" y2="460" class="b0 pbox" />
      <line x1="110" y1="375" x2="210" y2="460" class="b1 pbox" />
      <line x1="130" y1="375" x2="330" y2="460" class="b2 pbox" />
      <line x1="150" y1="375" x2="450" y2="460" class="b3 pbox" />

      <line x1="210" y1="375" x2="110" y2="460" class="b4 pbox" />
      <line x1="230" y1="375" x2="230" y2="460" class="b5 pbox" />
      <line x1="250" y1="375" x2="350" y2="460" class="b6 pbox" />
      <line x1="270" y1="375" x2="470" y2="460" class="b7 pbox" />

      <line x1="330" y1="375" x2="130" y2="460" class="b8 pbox isOne" />
      <line x1="350" y1="375" x2="250" y2="460" class="b9 pbox" />
      <line x1="370" y1="375" x2="370" y2="460" class="ba pbox" />
      <line x1="390" y1="375" x2="490" y2="460" class="bb pbox" />

      <line x1="450" y1="375" x2="150" y2="460" class="bc pbox" />
      <line x1="470" y1="375" x2="270" y2="460" class="bd pbox" />
      <line x1="490" y1="375" x2="390" y2="460" class="be pbox" />
      <line x1="510" y1="375" x2="510" y2="460" class="bf pbox" />
    </g>

    <!-- round 3 key -->
    <rect x="80" y="460" width="440" height="35" fill="transparent" />

    <!-- round 3 sbox input -->
    <g class="u3">
      <line x1="90" y1="495" x2="90" y2="530" class="b0" />
      <line x1="110" y1="495" x2="110" y2="530" class="b1" />
      <line x1="130" y1="495" x2="130" y2="530" class="b2 isOne" />
      <line x1="150" y1="495" x2="150" y2="530" class="b3" />

      <line x1="210" y1="495" x2="210" y2="530" class="b4" />
      <line x1="230" y1="495" x2="230" y2="530" class="b5" />
      <line x1="250" y1="495" x2="250" y2="530" class="b6" />
      <line x1="270" y1="495" x2="270" y2="530" class="b7" />

      <line x1="330" y1="495" x2="330" y2="530" class="b8" />
      <line x1="350" y1="495" x2="350" y2="530" class="b9" />
      <line x1="370" y1="495" x2="370" y2="530" class="ba" />
      <line x1="390" y1="495" x2="390" y2="530" class="bb" />

      <line x1="450" y1="495" x2="450" y2="530" class="bc" />
      <line x1="470" y1="495" x2="470" y2="530" class="bd" />
      <line x1="490" y1="495" x2="490" y2="530" class="be" />
      <line x1="510" y1="495" x2="510" y2="530" class="bf" />
    </g>

    <!-- round 3 sbox -->
    <rect x="80" y="530" width="80" height="35" fill="transparent" />
    <rect x="200" y="530" width="80" height="35" fill="transparent" />
    <rect x="320" y="530" width="80" height="35" fill="transparent" />
    <rect x="440" y="530" width="80" height="35" fill="transparent" />

    <!-- round 3 pbox -->
    <g class="v3">
      <line x1="90" y1="565" x2="90" y2="650" class="b0 pbox" />
      <line x1="110" y1="565" x2="210" y2="650" class="b1 pbox isOne" />
      <line x1="130" y1="565" x2="330" y2="650" class="b2 pbox" />
      <line x1="150" y1="565" x2="450" y2="650" class="b3 pbox isOne" />

      <line x1="210" y1="565" x2="110" y2="650" class="b4 pbox" />
      <line x1="230" y1="565" x2="230" y2="650" class="b5 pbox" />
      <line x1="250" y1="565" x2="350" y2="650" class="b6 pbox" />
      <line x1="270" y1="565" x2="470" y2="650" class="b7 pbox" />

      <line x1="330" y1="565" x2="130" y2="650" class="b8 pbox" />
      <line x1="350" y1="565" x2="250" y2="650" class="b9 pbox" />
      <line x1="370" y1="565" x2="370" y2="650" class="ba pbox" />
      <line x1="390" y1="565" x2="490" y2="650" class="bb pbox" />

      <line x1="450" y1="565" x2="150" y2="650" class="bc pbox" />
      <line x1="470" y1="565" x2="270" y2="650" class="bd pbox" />
      <line x1="490" y1="565" x2="390" y2="650" class="be pbox" />
      <line x1="510" y1="565" x2="510" y2="650" class="bf pbox" />
    </g>

    <!-- round 4 key -->
    <rect x="80" y="650" width="440" height="35" fill="transparent" />

    <!-- round 4 sbox input -->
    <g class="u4">
      <line x1="90" y1="685" x2="90" y2="720" class="b0" />
      <line x1="110" y1="685" x2="110" y2="720" class="b1" />
      <line x1="130" y1="685" x2="130" y2="720" class="b2" />
      <line x1="150" y1="685" x2="150" y2="720" class="b3" />

      <line x1="210" y1="685" x2="210" y2="720" class="b4 isOne" />
      <line x1="230" y1="685" x2="230" y2="720" class="b5" />
      <line x1="250" y1="685" x2="250" y2="720" class="b6" />
      <line x1="270" y1="685" x2="270" y2="720" class="b7" />

      <line x1="330" y1="685" x2="330" y2="720" class="b8" />
      <line x1="350" y1="685" x2="350" y2="720" class="b9" />
      <line x1="370" y1="685" x2="370" y2="720" class="ba" />
      <line x1="390" y1="685" x2="390" y2="720" class="bb" />

      <line x1="450" y1="685" x2="450" y2="720" class="bc isOne" />
      <line x1="470" y1="685" x2="470" y2="720" class="bd" />
      <line x1="490" y1="685" x2="490" y2="720" class="be" />
      <line x1="510" y1="685" x2="510" y2="720" class="bf" />
    </g>

    <!-- round 4 sbox -->
    <rect x="80" y="720" width="80" height="35" fill="transparent" />
    <rect x="200" y="720" width="80" height="35" fill="transparent" />
    <rect x="320" y="720" width="80" height="35" fill="transparent" />
    <rect x="440" y="720" width="80" height="35" fill="transparent" />

    <!-- round 5 key input -->
    <g class="v4">
      <line x1="90" y1="755" x2="90" y2="790" class="b0" />
      <line x1="110" y1="755" x2="110" y2="790" class="b1" />
      <line x1="130" y1="755" x2="130" y2="790" class="b2" />
      <line x1="150" y1="755" x2="150" y2="790" class="b3" />

      <line x1="210" y1="755" x2="210" y2="790" class="b4" />
      <line x1="230" y1="755" x2="230" y2="790" class="b5" />
      <line x1="250" y1="755" x2="250" y2="790" class="b6" />
      <line x1="270" y1="755" x2="270" y2="790" class="b7" />

      <line x1="330" y1="755" x2="330" y2="790" class="b8" />
      <line x1="350" y1="755" x2="350" y2="790" class="b9" />
      <line x1="370" y1="755" x2="370" y2="790" class="ba" />
      <line x1="390" y1="755" x2="390" y2="790" class="bb" />

      <line x1="450" y1="755" x2="450" y2="790" class="bc" />
      <line x1="470" y1="755" x2="470" y2="790" class="bd" />
      <line x1="490" y1="755" x2="490" y2="790" class="be" />
      <line x1="510" y1="755" x2="510" y2="790" class="bf" />
    </g>

    <!-- round 5 key -->
    <rect x="80" y="790" width="440" height="35" fill="transparent" />

    <!-- round 5 key output -->
    <g class="y">
      <line x1="90" y1="825" x2="90" y2="860" class="b0" />
      <line x1="110" y1="825" x2="110" y2="860" class="b1" />
      <line x1="130" y1="825" x2="130" y2="860" class="b2" />
      <line x1="150" y1="825" x2="150" y2="860" class="b3" />

      <line x1="210" y1="825" x2="210" y2="860" class="b4" />
      <line x1="230" y1="825" x2="230" y2="860" class="b5" />
      <line x1="250" y1="825" x2="250" y2="860" class="b6" />
      <line x1="270" y1="825" x2="270" y2="860" class="b7" />

      <line x1="330" y1="825" x2="330" y2="860" class="b8" />
      <line x1="350" y1="825" x2="350" y2="860" class="b9" />
      <line x1="370" y1="825" x2="370" y2="860" class="ba" />
      <line x1="390" y1="825" x2="390" y2="860" class="bb" />

      <line x1="450" y1="825" x2="450" y2="860" class="bc" />
      <line x1="470" y1="825" x2="470" y2="860" class="bd" />
      <line x1="490" y1="825" x2="490" y2="860" class="be" />
      <line x1="510" y1="825" x2="510" y2="860" class="bf" />
    </g>
  </g>
  <g>
    <!-- K1 -->
    <text x="293" y="103">K</text>
    <text class="sub" x="305" y="107">1</text>
    <!-- K2 -->
    <text x="293" y="293">K</text>
    <text class="sub" x="305" y="297">2</text>
    <!-- K3 -->
    <text x="293" y="483">K</text>
    <text class="sub" x="305" y="487">3</text>
    <!-- K4 -->
    <text x="293" y="673">K</text>
    <text class="sub" x="305" y="677">4</text>
    <!-- K5 -->
    <text x="293" y="813">K</text>
    <text class="sub" x="305" y="817">5</text>

    <!-- x -->
    <text x="40" y="70">x</text>

    <!-- u1 -->
    <text x="40" y="140">u</text>
    <text class="sub" x="53" y="145">1</text>
    <!-- v1 -->
    <text x="40" y="205">v</text>
    <text class="sub" x="53" y="210">1</text>
    <!-- w1 -->
    <text x="40" y="260">w</text>
    <text class="sub" x="53" y="265">1</text>

    <!-- u2 -->
    <text x="40" y="330">u</text>
    <text class="sub" x="53" y="335">2</text>
    <!-- v2 -->
    <text x="40" y="395">v</text>
    <text class="sub" x="53" y="400">2</text>
    <!-- w2 -->
    <text x="40" y="450">w</text>
    <text class="sub" x="53" y="455">2</text>

    <!-- u3 -->
    <text x="40" y="520">u</text>
    <text class="sub" x="53" y="525">3</text>
    <!-- v3 -->
    <text x="40" y="585">v</text>
    <text class="sub" x="53" y="590">3</text>
    <!-- w3 -->
    <text x="40" y="640">w</text>
    <text class="sub" x="53" y="645">3</text>

    <!-- u4 -->
    <text x="40" y="710">u</text>
    <text class="sub" x="53" y="715">4</text>
    <!-- v4 -->
    <text x="40" y="780">v</text>
    <text class="sub" x="53" y="785">4</text>

    <!-- y -->
    <text x="40" y="850">y</text>

    <!-- S -->
    <text x="114" y="175">S</text>
    <text x="234" y="175">S</text>
    <text x="354" y="175">S</text>
    <text x="474" y="175">S</text>

    <text x="114" y="365">S</text>
    <text x="234" y="365">S</text>
    <text x="354" y="365">S</text>
    <text x="474" y="365">S</text>

    <text x="114" y="555">S</text>
    <text x="234" y="555">S</text>
    <text x="354" y="555">S</text>
    <text x="474" y="555">S</text>

    <text x="114" y="745">S</text>
    <text x="234" y="745">S</text>
    <text x="354" y="745">S</text>
    <text x="474" y="745">S</text>
  </g>
</svg>
