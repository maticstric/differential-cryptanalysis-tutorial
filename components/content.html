<div id="sidebar">
</div>
<section id="content">
  <header>
    <img id="logo" src="images/logo.svg" width="80" />
    <h1>Differential Cryptanalysis Tutorial</h1>
  </header>
  <section>
    <h2>Abstract</h2>
    <p>This tutorial is a detailed and interactive introduction to differential cryptanalysis, a subtle, beautiful, and powerful method of breaking some of the world’s strongest ciphers. Unlike other currently available tutorials, it avoids needless math notation, makes very few assumptions about prior knowledge, does not gloss over details, and is written to be understood by novices with an interest in cryptography.</p>
    <p>Before continuing, know that there are two major prerequisites:</p>
    <ul>
      <li>You must be comfortable with binary and hexidecimal notation, especially how to convert between them</li>
      <li>We will be using differential cryptanalysis to break symmetric-key block ciphers. You should be familiar with this family of ciphers before learning a technique to break them</li>
    </ul>
  </section>
  <section>
    <h2>Introduction</h2>
    <p>Differential cryptanalysis was first discovered in the 1970s by the designers of the Data Encryption Standard (DES) at IBM. After a consultation with the NSA, the DES designers opted to keep the techinque a secret, because its release “would weaken the competitive advantage the United States enjoyed over other countries in the field of cryptography” {cite(biham)}. It remained classified until it was independently rediscovered and published in the early 1990s by Eli Biham and Adi Shamir, who are now credited with its discovery {cite(coppersmith)}.</p>
    <p>Before getting to the definition, it is important to note that differential cryptanalysis is what’s known as a “chosen plaintext” attack. This means that we, as attackers, may choose which plaintexts, and how many, we want encrypted by the cipher using the same secret key. This may not always be true in the real world since the same key often isn’t used for a very long time, and during that time it can be difficult or impossible to encrypt whichever plaintext you wish. Nevertheless, we must make this assumption for the attack to work.</p>
    <hr/>
    <p>Block ciphers work by repeatedly applying a set of transformations (key addition, substitution, permutation, etc.) to a plaintext, until a ciphertext is obtained. The security of the cipher depends on the attacker never knowing/guessing any intermediate value during encryption; we can only see the plaintext (remember, chosen plaintext) and ciphertext, nothing more.</p>
    <p>However, as we will explain thoroughly in this tutorial, we <em>can</em> know/guess the intermediate value of the <em>difference of two plaintexts</em> during encryption (this is why the technique is called <em>differential</em> cryptanalysis). This is a very subtle point and one that can be difficult to wrap your mind around, but is paramount to understanding how differential cryptanalysis can recover the secret key and therefore break the cipher.</p>
    <p>As you will see, this “difference” is measured via a simple bitwise XOR of the two plaintexts.</em>
    <p>Now that we have the basics, let’s get to breaking our first cipher!</p>
  </section>
  <section>
    <header>
      <h2>Toy Cipher</h2>
      <blockquote>
        <p>If you can’t solve a problem, then there is an easier problem you can’t solve: find it.</p>
        <cite>—Pólya/Conway</cite>
      </blockquote>
    </header>
    <p>Let’s begin by breaking the simplest block cipher worth breaking which we’ll call the “toy cipher”. The toy cipher is <em>just</em> complicated enough to make differential cryptanalysis a valid method to break it, but no more. Note that it is trivial to break the toy cipher by bruteforce. Nevertheless, it will serve as a great introduction to the main concepts behind differential cryptanalysis.</p>
    <section>
      <h3>Toy Cipher Definition</h3>
      <p>The toy cipher has a block size of 4 bits (also known as a nibble), meaning that we’ll input 4 bits into the cipher and it will return 4 bits of ciphertext. The toy cipher also has a 4 bit substitution box (SBOX) and two separate 4 bit keys (<i>k<sub>0</sub></i> and <i>k<sub>1</sub></i>).</p>
      <p>Now let’s look at how we can encrypt a nibble with the toy cipher. There are three steps:</p>
      <ol>
        <li>We XOR the plaintext with <i>k<sub>0</sub></i></li>
        <li>Feed that result into the SBOX</li>
        <li>XOR the output of the SBOX with <i>k<sub>1</sub></i></li>
      </ol>
      <p>These simple steps give us the final ciphertext. The cipher is much easier to understand visually so look to the diagram below. Note that the values underlined with purple can be changed. Play around with different values to see how the cipher is affected. The red lines represent the 1s and the black lines the 0s as the nibble makes its way through the cipher. Also note the labels <i>x</i>, <i>u</i>, <i>v</i>, and <i>y</i> on the left (<i>x</i> is the value of the plaintext, <i>u</i> is the value after the fist key addition, etc.). Those labels will make it easier to discuss the cipher when we get to differential cryptanalysis so keep them in mind.</p>
      {{toy-visualization.html}}
    </section>
    <section>
      <h3>Differential Cryptanalysis of the Toy Cipher</h3>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
    </section>
  </section>
  <section>
    <h2>SPN</h2>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
    {{spn-visualization.html}}
    <section>
      <h3>SPN Definition</h3>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
    </section>
    <section>
      <h3>Differential Cryptanalysis of an SPN</h3>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
    </section>
  </section>
  <section>
    <h2>Modern Cryptography</h2>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
  </section>
  <section>
    <h2>Bibliography</h2>
    <ol id="bibliography">
      <li id="biham">Biham, Eli and Adi Shamir. “Differential Cryptanalysis of DES-like Cryptosystems.” <i>Journal of Cryptology</i> 4, no. 1 (January 1991): 3–72. https://doi.org/10.1007/BF00630563.</li>
      <li id="coppersmith">Coppersmith, Don. “The Data Encryption Standard (DES) and its strength against attacks” <i>IBM Journal of Research and Development</i> 38, no. 3 (May 1994): 243–250. https://doi.org/10.1147/rd.383.0243.</li>
    </ol>
  </section>
</section>
<script src="js/generate-section-numbers.js"></script>
<script src="js/generate-citation-numbers.js"></script>
<script src="js/generate-toc.js"></script>
